(()=>{"use strict";class e{constructor(e,t,s,o){this._name=e,this._link=t,this._templateSelector=o,this.handleCardClick=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._element.querySelector(".element__title").textContent=this._name,this._image=this._element.querySelector(".element__image"),this._image.alt=this._name,this._image.src=this._link,this._detete=this._element.querySelector(".element__delete"),this._button=this._element.querySelector(".element__like-button"),this._setEventListeners(),this._element}_likeCard(){this._button.classList.toggle("element__like-button_active")}_deleteCard(){this._element.remove(),this._element=null}openImg(){this.handleCardClick(this._name,this._link)}_setEventListeners(){this._button.addEventListener("click",(()=>{this._likeCard()})),this._detete.addEventListener("click",(()=>{this._deleteCard()})),this._image.addEventListener("click",(()=>{this.openImg()}))}}class t{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._popupCloseButton=this._popup.querySelector(".popup__close")}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()})),this._popupCloseButton.addEventListener("click",(()=>{this.close()}))}}class s extends t{constructor(e,t){super(e),this.formSubmitAdd=t,this._form=this._popup.querySelector(".form"),this._input=this._popup.querySelectorAll(".form__item"),this._formButton=this._popup.querySelectorAll(".popup__saved-button")}close(){super.close(),this._form.reset()}_getInputValues(){return this.values={},this._input.forEach((e=>{this.values[e.name]=e.value})),this.values}setInputsValues(e){this._input.forEach((t=>{t.value=e[t.name]}))}_onSubmit=e=>{e.preventDefault(),this.formSubmitAdd(this._getInputValues())};setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this._onSubmit)}}const o={formSelector:".form",inputSelector:".form__item",submitButtonSelector:".popup__saved-button",inactiveButtonClass:"popup__saved-button_disabled",inputErrorClass:"form__item-error",errorClass:"error_opened"};class r{constructor(e,t){this.formSelector=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=Array.from(this.formSelector.querySelectorAll(this._inputSelector)),this._submitButton=this.formSelector.querySelector(this._submitButtonSelector)}_enableButton(e){e.classList.remove(this._inactiveButtonClass),e.removeAttribute("disabled")}disableButton(e){e.classList.add(this._inactiveButtonClass),e.setAttribute("disabled",!0)}_showInputError(e){const t=document.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=document.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_checkInputValidity(e){e.checkValidity()?this._hideInputError(e):this._showInputError(e)}setEventListeners(){this.disableButton(this._submitButton),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this.toggleButtonState(),this._checkInputValidity(e)}))}))}toggleButtonState(){this._hasInvalidInput(this._inputList)?this.disableButton(this._submitButton):this._enableButton(this._submitButton)}resetValidation(){this.toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this.setEventListeners()}}const i=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers,this._authorization=e.headers.authorization}getInitialCards(){}_checkResponse(e){return e.ok?e.json():Promise.reject(`Что-то пошло не так: ${e.status}`)}getInfo(){return fetch(`${this._url}/users/me`,{headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._checkResponse)}getCard(){return fetch(`${this._url}/cards`,{headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._checkResponse)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-66",headers:{authorization:"26786be3-fed9-4d83-9ae2-1348eee1b7d5","Content-Type":"application/json"}}),n=document.querySelector(".popup_type_edit"),l=document.querySelector(".popup_type_add"),a=document.querySelector(".popup_type_image"),u=(a.querySelector(".popup__text"),a.querySelector(".popup__image"),document.querySelector(".profile")),_=u.querySelector(".profile__edit-button"),c=u.querySelector(".profile__add-button"),p=n.querySelector(".form"),h=l.querySelector(".form"),d=(p.querySelector(".form__item_type_name"),p.querySelector(".form__item_type_job"),p.querySelector(".popup__saved-button"),l.querySelector(".popup__saved-button"),document.querySelector(".elements__list-template"),l.querySelector(".form__item_type_name"),l.querySelector(".form__item_type_job"),new class extends t{constructor(e){super(e),this._image=this._popup.querySelector(".popup__image"),this._text=this._popup.querySelector(".popup__text")}open=(e,t)=>{this._text.textContent=e,this._image.alt=e,this._image.src=t,super.open()}}(".popup_type_image"));d.setEventListeners();const m=new class{constructor(e){this._profileName=document.querySelector(e.nameSelector),this._profileText=document.querySelector(e.jobSelector),this._profileAvatar=document.querySelector(e.avatarSelector)}getUserInfo(){return{firstname:this._profileName.textContent,description:this._profileText.textContent}}serUserInfo({avatar:e,firstname:t,description:s}){this._profileAvatar.src=e,this._profileName.textContent=t,this._profileText.textContent=s}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__avatar"}),S=new s(".popup_type_edit",(function(e){m.serUserInfo(e),S.close()}));S.setEventListeners(),_.addEventListener("click",(function(){S.setInputsValues(m.getUserInfo()),console.log(m.getUserInfo()),S.open()}));const f=new s(".popup_type_add",(function(e){console.log("open"),v.addItem(y(e)),f.close()}));function y(t){return new e(t.name,t.link,d.open,".elements-template").generateCard()}f.setEventListeners(),c.addEventListener("click",(function(){f.open()}));const v=new class{constructor(e,t){this.renderer=e,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(e){e.forEach((e=>{this.renderer(e)}))}}((e=>{v.addItem(y(e))}),".elements__list-template"),b=new r(o,p),C=new r(o,h);b.enableValidation(),C.enableValidation(),Promise.all([i.getInfo(),i.getCard()]).then((([e,t])=>{console.log(t),t.forEach((t=>{t.myid=e._id})),console.log(e),m.serUserInfo({avatar:e.avatar,firstname:e.name,description:e.about}),v.renderItems(t)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjNHLG9CQUdsQnNGLEVBQXdCbkcsaUJBQWlCLFNBQ3pDLFdBQ0l3SCxFQUFrQmpILE1BQ3RCLElBWUEsTUFXTWtILEVBQW1CLElJNUlWLE1BQ1h0SixZQUFZeUosRUFBVUMsR0FHbEJySixLQUFLb0osU0FBV0EsRUFDaEJwSixLQUFLc0osV0FBYWpKLFNBQVNDLGNBQWMrSSxFQUM3QyxDQUNBSCxRQUFRSyxHQUVMdkosS0FBS3NKLFdBQVdFLFFBQVFELEVBQzNCLENBQ0FFLFlBQVlDLEdBRVJBLEVBQUt4RyxTQUFRdUMsSUFDVHpGLEtBQUtvSixTQUFTM0QsRUFBSyxHQUV2QixJSjRIOEJBLElBQzlCd0QsRUFBaUJDLFFBQVFDLEVBQVcxRCxHQUFNLEdBWnpCLDRCQW9CbkJrRSxFQUFvQixJQUFJM0YsRUFBY1AsRUFBa0JtRSxHQUN4RGdDLEVBQW1CLElBQUk1RixFQUFjUCxFQUFrQm9FLEdBRzdEOEIsRUFBa0IxRCxtQkFDbEIyRCxFQUFpQjNELG1CQUVqQmMsUUFBUThDLElBQUksQ0FBQzNELEVBQUlnQixVQUFXaEIsRUFBSW1CLFlBQy9CRCxNQUFLLEVBQUU5RCxFQUFVd0csTUFDYmhCLFFBQVFDLElBQUllLEdBQ1pBLEVBQVM1RyxTQUFRcUcsSUFDZEEsRUFBUVEsS0FBT3pHLEVBQVMwRyxHQUFHLElBRS9CbEIsUUFBUUMsSUFBSXpGLEdBQ1oyRSxFQUFTVSxZQUFZLENBQUVDLE9BQVF0RixFQUFTc0YsT0FBUUgsVUFBV25GLEVBQVMxRCxLQUFNOEksWUFBYXBGLEVBQVMyRyxRQUNoR2hCLEVBQWlCUSxZQUFZSyxFQUFTLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbmNvbnN0cnVjdG9yKG5hbWUsIGxpbmssIGhhbmRsZUNhcmRDbGljaywgdGVtcGxhdGVTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgfVxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIC8vINC30LDQsdC40YDQsNC10Lwg0YDQsNC30LzQtdGC0LrRgyDQuNC3IEhUTUwg0Lgg0LrQu9C+0L3QuNGA0YPQtdC8INGN0LvQtdC80LXQvdGCXHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxyXG4gICAgICAgICAgICAuY29udGVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnQnKVxyXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICAgIH1cclxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pbWFnZScpXHJcbiAgICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5fZGV0ZXRlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fZGVsZXRlJylcclxuICAgICAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlLWJ1dHRvbicpXHJcblxyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKClcclxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQpNGD0L3QutGG0LjRjyDQu9Cw0LnQutCwXHJcbiAgICBfbGlrZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2VsZW1lbnRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpXHJcbiAgICB9O1xyXG4gICAgLy/QpNGD0L3QutGG0LjRjyDRg9C00LDQu9C10L3QuNGPXHJcbiAgICBfZGVsZXRlQ2FyZCgpIHtcclxuICAgICAgICAvL3RoaXMuX2RldGV0ZSA9IHRoaXMuX2RldGV0ZS5jbG9zZXN0KCcuZWxlbWVudCcpXHJcbiAgICAgICAgLy90aGlzLl9kZXRldGUucmVtb3ZlKClcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGxcclxuICAgIH1cclxuICAgIC8vINCk0YPQvdC60YbQuNGPINC+0YLQutGA0YvRgtC40Y8g0LrQsNGA0YLQuNC90LrQuCBcclxuICAgIC8vIGhhbmRsZUNhcmRDbGljaygpe1xyXG4gICAgLy8gICAgIHRoaXMuX2ltYWdlLm9wZW4oKVxyXG4gICAgLy8gfVxyXG4gICAgb3BlbkltZyAoKXtcclxuICAgICAgICB0aGlzLmhhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKVxyXG4gICAgfVxyXG4gICAgLy/RgdC70YPRiNCw0YLQtdC70LhcclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAvL9GB0LvRg9GI0LDRgtC10LvRjCDQu9Cw0LnQutCwXHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9saWtlQ2FyZCgpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy/RgdC70YPRiNCw0YLQtdC70Ywg0YPQtNCw0LvRj9C70LrQuFxyXG4gICAgICAgIHRoaXMuX2RldGV0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fZGVsZXRlQ2FyZCgpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8g0YHQu9GD0YjQsNGC0LXQu9GMINC+0YLQutGA0YvRgtC40Y8g0LrQsNGA0YLQuNC90LrQuCBcclxuICAgICAgICAvLyB0aGlzLl9pbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAvLyAgICAgdGhpcy5oYW5kbGVDYXJkQ2xpY2soKTtcclxuICAgICAgICAvLyB9KVxyXG5cclxuICAgICAgICAgIHRoaXMuX2ltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9wZW5JbWcoKVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gdGhpcy5faW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuaGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXHJcbiAgICAgICAgLy8gICB9KTtcclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICAvL3RoaXMuX3BvcHVwID0gcG9wdXBTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy/QntGC0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8vL1xyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpXHJcblxyXG4gICAgfVxyXG4gICAgLy/Ql9Cw0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8vL1xyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKVxyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKVxyXG4gICAgfVxyXG4gICAgLy/Ql9Cw0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8gRXNjLy9cclxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvL9Ch0LvRg9GI0LDRgtC10LvRjCDQt9Cw0LrRgNGL0YLQuNGPLCDQvdCw0LbQuNC80LDRjyDQvdCwINGC0LXQvNC9LtGN0LrRgNCw0L0g0Lgg0LfQsNC60YDRi9GC0LjQtSDQvdCwINC60L3QvtC/0LrRgyDQutGA0LXRgdGC0LjQui8vXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldClcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgZm9ybVN1Ym1pdEFkZCkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuZm9ybVN1Ym1pdEFkZCA9IGZvcm1TdWJtaXRBZGQ7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XHJcbiAgICAgICAgdGhpcy5faW5wdXQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybV9faXRlbScpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1CdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX3NhdmVkLWJ1dHRvbicpO1xyXG4gICAgfVxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKVxyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMudmFsdWVzID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXQuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlcztcclxuICAgIH1cclxuICAgIHNldElucHV0c1ZhbHVlcyhkYXRhVXNlcikge1xyXG4gICAgICAgIHRoaXMuX2lucHV0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICBpbnB1dC52YWx1ZSA9IGRhdGFVc2VyW2lucHV0Lm5hbWVdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgX29uU3VibWl0ID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMuZm9ybVN1Ym1pdEFkZCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9vblN1Ym1pdCkgXHJcbiAgICB9XHJcblxyXG4gICAgLy8gc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIC8vICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgIC8vICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAvLyAgICAgICAgIHRoaXMuZm9ybVN1Ym1pdEFkZCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIC8vICAgICB9KVxyXG4gICAgICAgLy8gdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLmZvcm1TdWJtaXRBZGQpXHJcbiAgICAgICAgLy8gKGV2dCkgPT4geyBcclxuICAgICAgICAvLyAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuX2Zvcm1TdWJtaXRBZGQodGhpcy5nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgICAvLyAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgICAgLy8gfSlcclxuICAgIH1cclxuICAgICAgICBcclxuXHJcbiAgICBcclxuXHJcbiIsImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0gKHtcclxuICAgIGZvcm1TZWxlY3RvcjogJy5mb3JtJyxcclxuICAgIGlucHV0U2VsZWN0b3I6ICcuZm9ybV9faXRlbScsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fc2F2ZWQtYnV0dG9uJyxcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fc2F2ZWQtYnV0dG9uX2Rpc2FibGVkJyxcclxuICAgIGlucHV0RXJyb3JDbGFzczogJ2Zvcm1fX2l0ZW0tZXJyb3InLFxyXG4gICAgZXJyb3JDbGFzczogJ2Vycm9yX29wZW5lZCdcclxufSk7XHJcblxyXG5leHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm0pIHtcclxuICAgICAgICB0aGlzLmZvcm1TZWxlY3RvciA9IGZvcm0sXHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcixcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IsXHJcbiAgICAgICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyxcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcyxcclxuICAgICAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzLFxyXG5cclxuICAgICAgICAgICAgLy90aGlzLl9mb3JtID0gQXJyYXkuZnJvbSh0aGlzLmZvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKVxyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuX2Zvcm0pXHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5mb3JtU2VsZWN0b3IucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSlcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLmZvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKVxyXG4gICAgfVxyXG5cclxuICAgIC8vINC60L3QvtC/0LrQsCDQsNC60YLQuNCyXHJcbiAgICBfZW5hYmxlQnV0dG9uKGJ1dHRvbikge1xyXG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpXHJcbiAgICAgICAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpXHJcbiAgICB9XHJcbiAgICAvLyDQutC90L7Qv9C60LAg0L3QtdCw0LrRgtC40LJcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uKSB7XHJcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcylcclxuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDQpNGD0L3QutGG0LjRjyAg0L/QvtC70Y8gYyDQvtGI0LjQsdC60L7QuVxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0KSB7XHJcbiAgICAgICAgY29uc3QgZm9ybUVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGZvcm1FcnJvci50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlXHJcbiAgICAgICAgZm9ybUVycm9yLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vICAvLyDQpNGD0L3QutGG0LjRjyAg0L/QvtC70Y8g0LHQtdC3INC+0YjQuNCx0LrQuFxyXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0KSB7XHJcbiAgICAgICAgY29uc3QgZm9ybUVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGZvcm1FcnJvci50ZXh0Q29udGVudCA9IFwiXCJcclxuICAgICAgICBmb3JtRXJyb3IuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH07XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dChmb3JtSW5wdXQpIHtcclxuICAgICAgICByZXR1cm4gZm9ybUlucHV0LnNvbWUoaXRlbSA9PiAhaXRlbS52YWxpZGl0eS52YWxpZClcclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XHJcbiAgICAgICAgaWYgKGlucHV0LmNoZWNrVmFsaWRpdHkoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dClcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyAvL9GE0YPQvdC60YbQuNGPINGB0LvRg9GI0LDRgtC10LvQtdC5XHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAgICB0aGlzLmRpc2FibGVCdXR0b24odGhpcy5fc3VibWl0QnV0dG9uKVxyXG4gICAgICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KVxyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbilcclxuICAgICAgICAgICAgLy8gICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vICAgICB0aGlzLl9lbmFibGVCdXR0b24odGhpcy5fc3VibWl0QnV0dG9uKVxyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfTtcclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKCl7XHJcbiAgICBcclxuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbilcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAodGhpcy5fZW5hYmxlQnV0dG9uKCh0aGlzLl9zdWJtaXRCdXR0b24pKSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IFxyXG4gIFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcclxuICAgICAgICB9KTtcclxuICBcclxuICAgICAgfVxyXG4gICAgLy8gICAvL9GE0YPQvdC60YbQuNGPINC30LDQv9GD0YHQutCwINCy0YvQu9C40LTQsNGG0LjQuFxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKClcclxuICAgIH1cclxufVxyXG5cclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gJy4uL2NvbXBvbmVudHMvU2VjdGlvbi5qcydcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMnXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcydcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnXHJcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnXHJcblxyXG5pbXBvcnQgeyB2YWxpZGF0aW9uQ29uZmlnIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJ1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJ1xyXG4vL2ltcG9ydCB7IGluaXRpYWxDYXJkcyB9IGZyb20gJy4uL3V0aWxzcy9jb25zdGFudHMuanMnXHJcblxyXG5pbXBvcnQgJy4vaW5kZXguY3NzJ1xyXG4vL2luaXRpYWxDYXJkcy5yZXZlcnNlKCk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICAgIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTY2JyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogJzI2Nzg2YmUzLWZlZDktNGQ4My05YWUyLTEzNDhlZWUxYjdkNScsXHJcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgIH1cclxuICB9KTsgXHJcblxyXG4vLyAgIGNvbnNvbGUubG9nKGFwaSlcclxuXHJcblxyXG4vLyAgIGFwaS5nZXRDYXJkKClcclxuLy8gICAgIC50aGVuKHJlcyA9PiBjb25zb2xlLmxvZyhyZXMpKVxyXG5cclxuLy8gICBhcGkuZ2V0SW5mbygpXHJcbi8vICAgICAudGhlbihyZXMgPT4gY29uc29sZS5sb2cocmVzKSlcclxuXHJcblxyXG4vLyDQndCw0YXQvtC00LjQvCBwb3B1cFxyXG5jb25zdCBwb3B1cEVkaXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2VkaXRcIik7XHJcbmNvbnN0IHBvcHVwQWRkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGRcIik7XHJcbmNvbnN0IHBvcHVwT3BlbkltYWdlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9pbWFnZVwiKTtcclxuXHJcbmNvbnN0IHBvcHVwT3BlbkltYWdlVGV4dCA9IHBvcHVwT3BlbkltYWdlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX190ZXh0XCIpO1xyXG5jb25zdCBwb3B1cE9wZW5JbWFnZSA9IHBvcHVwT3BlbkltYWdlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuLy9leHBvcnQgeyBwb3B1cE9wZW5JbWFnZUVsZW1lbnQsIHBvcHVwT3BlbkltYWdlVGV4dCwgcG9wdXBPcGVuSW1hZ2UgfVxyXG5cclxuLy8g0J3QsNGF0L7QtNC40Lwg0LrQvdC+0L/QutC4XHJcbmNvbnN0IHByb2ZpbGVCdXR0b25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQgPSBwcm9maWxlQnV0dG9uRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQnV0dG9uRWxlbWVudCA9IHByb2ZpbGVCdXR0b25FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbi8vINCd0LDRhdC+0LTQuNC8INC/0L7Qu9GPINGE0L7RgNC80Ysg0LIgRE9NXHJcbmNvbnN0IGZvcm1FbGVtZW50RWRpdCA9IHBvcHVwRWRpdEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG5jb25zdCBmb3JtRWxlbWVudEFkZCA9IHBvcHVwQWRkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcblxyXG5jb25zdCBuYW1lRWRpdElucHV0ID0gZm9ybUVsZW1lbnRFZGl0LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faXRlbV90eXBlX25hbWVcIik7XHJcbmNvbnN0IGpvYkVkaXRJbnB1dCA9IGZvcm1FbGVtZW50RWRpdC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2l0ZW1fdHlwZV9qb2JcIik7XHJcblxyXG5cclxuY29uc3QgYnV0dG9uU2F2ZWRJbnB1dCA9IGZvcm1FbGVtZW50RWRpdC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBidXR0b25DcmVhdGVJbnB1dCA9IHBvcHVwQWRkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19zYXZlZC1idXR0b25cIik7XHJcblxyXG4vLyBjb25zdCBuYW1lVGl0bGUgPSBwcm9maWxlQnV0dG9uRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG4vLyBjb25zdCBqb2JTdWJ0aXRsZSA9IHByb2ZpbGVCdXR0b25FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fc3VidGl0bGVcIik7XHJcblxyXG5jb25zdCBsaXN0Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fbGlzdC10ZW1wbGF0ZScpXHJcbmNvbnN0IG5hbWVBZGRJbnB1dCA9IHBvcHVwQWRkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2l0ZW1fdHlwZV9uYW1lXCIpO1xyXG5jb25zdCBqb2JBZGRJbnB1dCA9IHBvcHVwQWRkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2l0ZW1fdHlwZV9qb2JcIik7XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgcG9wdXBPcGVuSW1hZ2VFbGVtZW50U2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2ltYWdlXCJcclxuXHJcbmNvbnN0IHBvcHVwT3BlbkltYWdlU2VjdGlvbiA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cE9wZW5JbWFnZUVsZW1lbnRTZWxlY3RvcilcclxucG9wdXBPcGVuSW1hZ2VTZWN0aW9uLnNldEV2ZW50TGlzdGVuZXJzKClcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuLy/Qn9C+0L/QsNC/IEVESVRcclxuY29uc3QgY29uZmlnID0ge1xyXG4gICAgbmFtZVNlbGVjdG9yOiAnLnByb2ZpbGVfX3RpdGxlJyxcclxuICAgIGpvYlNlbGVjdG9yOiAnLnByb2ZpbGVfX3N1YnRpdGxlJyxcclxuICAgIGF2YXRhclNlbGVjdG9yOiAnLnByb2ZpbGVfX2F2YXRhcidcclxufVxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhjb25maWcpO1xyXG4vLy/QodC+0LHRi9GC0LjQtSBFRElULy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5jb25zdCBwb3B1cEVkaXRFbGVtZW50U2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2VkaXRcIlxyXG5jb25zdCBlZGl0UG9wdXBXaXRoRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwRWRpdEVsZW1lbnRTZWxlY3RvciwgZm9ybVN1Ym1pdEVkaXQpXHJcblxyXG5mdW5jdGlvbiBmb3JtU3VibWl0RWRpdChpdGVtKSB7XHJcbiAgICB1c2VySW5mby5zZXJVc2VySW5mbyhpdGVtKTtcclxuICAgIGVkaXRQb3B1cFdpdGhGb3JtLmNsb3NlKClcclxufVxyXG5lZGl0UG9wdXBXaXRoRm9ybS5zZXRFdmVudExpc3RlbmVycygpXHJcbi8vL9CY0LrQvtC90LrQsCBFRElULy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5wcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnRGdW5jdGlvbik7XHJcbmZ1bmN0aW9uIHByb2ZpbGVFZGl0QnV0dG9uRWxlbWVudEZ1bmN0aW9uKCkge1xyXG4gICAgZWRpdFBvcHVwV2l0aEZvcm0uc2V0SW5wdXRzVmFsdWVzKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpXHJcbiAgICBjb25zb2xlLmxvZyh1c2VySW5mby5nZXRVc2VySW5mbygpKTtcclxuICAgIGVkaXRQb3B1cFdpdGhGb3JtLm9wZW4oKVxyXG59XHJcblxyXG4vLyBmdW5jdGlvbiBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnRGdW5jdGlvbigpIHtcclxuLy8gICAgIGVkaXRQb3B1cFdpdGhGb3JtLm9wZW4oKVxyXG4vLyAgICAgY29uc3QgcHJvZmlsZURhdGEgID0gdXNlckluZm8uZ2V0VXNlckluZm8oKSAvLyDQktC+0YIg0YLRg9GCINCyINC/0LXRgNC10LzQtdC90L3Rg9GOIHByb2ZpbGVEYXRhINC/0L7Qu9C+0LbQuNC70Lgg0L7QsdGK0LXQutGCLCDRgtC+0YIg0YfRgtC+INGC0Ysg0LrQvtC90YHQvtC70YzQu9C+0LPQuNGA0YPQtdGI0Ywg0L3QsCDRgdC60YDQuNC90YjQvtGC0LUgXHJcbi8vICAgY29uc29sZS5sb2cocHJvZmlsZURhdGEpO1xyXG4vLyAgICAgbmFtZUVkaXRJbnB1dC52YWx1ZSA9IHByb2ZpbGVEYXRhLmZpcnN0bmFtZVxyXG4vLyAgICAgam9iRWRpdElucHV0LnZhbHVlID0gcHJvZmlsZURhdGEuZGVzY3JpcHRpb25cclxuLy8gICB9XHJcbiAgXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8v0J/QvtC/0LDQvyBBRFxyXG4vL9Cf0KDQntCR0JvQldCc0JAg0KEg0KHQntCR0KvQotCY0JXQnC8vXHJcbmNvbnN0IHBvcHVwQWRkRWxlbWVudFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9hZGRcIlxyXG5jb25zdCBhZGR0UG9wdXBXaXRoRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwQWRkRWxlbWVudFNlbGVjdG9yLCBmb3JtU3VibWl0QWRkKVxyXG5cclxuZnVuY3Rpb24gZm9ybVN1Ym1pdEFkZChpdGVtKSB7XHJcbiAgICBjb25zb2xlLmxvZygnb3BlbicpO1xyXG4gICAgY2FyZHNMaXN0U2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoaXRlbSkpO1xyXG4gICAgYWRkdFBvcHVwV2l0aEZvcm0uY2xvc2UoKVxyXG59O1xyXG5hZGR0UG9wdXBXaXRoRm9ybS5zZXRFdmVudExpc3RlbmVycygpXHJcblxyXG4vLy/QmNC60L7QvdC60LAgQURELy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5wcm9maWxlQWRkQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHByb2ZpbGVBZGRCdXR0b25FbGVtZW50RnVuY3Rpb24pO1xyXG5mdW5jdGlvbiBwcm9maWxlQWRkQnV0dG9uRWxlbWVudEZ1bmN0aW9uKCkge1xyXG4gICAgYWRkdFBvcHVwV2l0aEZvcm0ub3BlbigpXHJcbn1cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL9GA0LXQsNC70LjQt9Cw0YbQuNGPINC60LvQsNGB0YHQsCBTZWN0aW9uLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgICBjb25zdCBjYXJkcyA9IG5ldyBDYXJkKGl0ZW0ubmFtZSwgaXRlbS5saW5rLCBwb3B1cE9wZW5JbWFnZVNlY3Rpb25cclxuICAgICAgICAub3BlbiwgJy5lbGVtZW50cy10ZW1wbGF0ZScpO1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkcy5nZW5lcmF0ZUNhcmQoKVxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5jb25zdCBjYXJkTGlzdFNlbGVjdG9yID0gJy5lbGVtZW50c19fbGlzdC10ZW1wbGF0ZSc7XHJcbi8vIGNvbnN0IGNhcmRzTGlzdFNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XHJcbi8vICAgICBkYXRhOiBpbml0aWFsQ2FyZHMsXHJcbi8vICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuLy8gICAgICAgICBjYXJkc0xpc3RTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChpdGVtKSk7XHJcbi8vICAgICB9XHJcbi8vIH0sXHJcbi8vICAgICBjYXJkTGlzdFNlbGVjdG9yXHJcbi8vICk7XHJcbi8vIGNhcmRzTGlzdFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuXHJcbmNvbnN0IGNhcmRzTGlzdFNlY3Rpb24gPSBuZXcgU2VjdGlvbigoaXRlbSkgPT4ge1xyXG4gICAgICAgIGNhcmRzTGlzdFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxufSxcclxuICAgIGNhcmRMaXN0U2VsZWN0b3JcclxuKTtcclxuLy9jYXJkc0xpc3RTZWN0aW9uLnJlbmRlckl0ZW1zKGluaXRpYWxDYXJkcylcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4vL9CU0LvRjyDQutCw0LbQtNC+0Lkg0YHQvtC30LTQsNC10Lwg0Y3QutGA0LXQvNC/0LvRj9GAINC60LvQsNGB0YHQsCDQstCw0LvQuNC00LDRgtC+0YDQsC4g0K3QutC30LXQvNC/0LvRj9GAINC40LvQuCDQuNC90YHRgtCw0L3RgSAtINGN0YLQviDRgNC10LfRg9C70YzRgtCw0YIg0LLRi9C30L7QstCwIG5ldyBGb3JtVmFsaWRhdG9yKClcclxuY29uc3QgZm9ybUVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtRWxlbWVudEVkaXQpXHJcbmNvbnN0IGZvcm1BZGRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtRWxlbWVudEFkZClcclxuXHJcbi8vICAvL1wi0JLQutC70Y7Rh9Cw0LXQvFwiINC/0L7QtNC/0LjRgdC60Lgg0L3QsCDQuNC30LzQtdC90LXQvdC40Y8g0LIg0LjQvdC/0YPRgtCw0YVcclxuZm9ybUVkaXRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpXHJcbmZvcm1BZGRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpXHJcblxyXG5Qcm9taXNlLmFsbChbYXBpLmdldEluZm8oKSwgYXBpLmdldENhcmQoKV0pXHJcbi50aGVuKChbZGF0YVVzZXIsIGRhdGFDYXJkXSkgPT4ge1xyXG4gICAgIGNvbnNvbGUubG9nKGRhdGFDYXJkKTtcclxuICAgICBkYXRhQ2FyZC5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgIGVsZW1lbnQubXlpZCA9IGRhdGFVc2VyLl9pZFxyXG4gICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2coZGF0YVVzZXIpO1xyXG4gICAgdXNlckluZm8uc2VyVXNlckluZm8oeyBhdmF0YXI6IGRhdGFVc2VyLmF2YXRhciwgZmlyc3RuYW1lOiBkYXRhVXNlci5uYW1lLCBkZXNjcmlwdGlvbjogZGF0YVVzZXIuYWJvdXR9KVxyXG4gICAgY2FyZHNMaXN0U2VjdGlvbi5yZW5kZXJJdGVtcyhkYXRhQ2FyZClcclxufSkiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmxcclxuICAgICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVyc1xyXG4gICAgICB0aGlzLl9hdXRob3JpemF0aW9uID0gb3B0aW9ucy5oZWFkZXJzLmF1dGhvcml6YXRpb25cclxuICAgIH1cclxuICBcclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgLy8gLi4uXHJcbiAgICB9XHJcbiAgXHJcbiAgICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0KfRgtC+LdGC0L4g0L/QvtGI0LvQviDQvdC1INGC0LDQujogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluZm8oKXtcclxuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICAgIC8vLnRoZW4ocmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCk6IFByb21pc2UucmVqZWN0KVxyXG4gICAgfVxyXG4gICAgZ2V0Q2FyZCgpe1xyXG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICAgIH1cclxuICB9IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fdGV4dCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3RleHRcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuID0gKHRpdGxlLCBsaW5rKSA9PiB7XHJcbiAgICB0aGlzLl90ZXh0LnRleHRDb250ZW50ID0gdGl0bGU7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSB0aXRsZVxyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHN1cGVyLm9wZW4oKVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICAgICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLm5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9maWxlVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmpvYlNlbGVjdG9yKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hdmF0YXJTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBmaXJzdG5hbWU6ICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9wcm9maWxlVGV4dC50ZXh0Q29udGVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBzZXJVc2VySW5mbyh7YXZhdGFyLCBmaXJzdG5hbWUsIGRlc2NyaXB0aW9ufSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXJcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZmlyc3RuYW1lXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9maWxlVGV4dC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgfVxyXG4vLyBleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbi8vICAgICBjb25zdHJ1Y3RvcihuYW1lLCB0ZXh0KSB7XHJcbi8vICAgICAgICAgdGhpcy5faW5wdXROYW1lID0gbmFtZVxyXG4vLyAgICAgICAgIHRoaXMuX2lucHV0VGV4dCA9IHRleHRcclxuLy8gICAgICAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xyXG4vLyAgICAgICAgIHRoaXMuX3Byb2ZpbGVUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3N1YnRpdGxlJyk7XHJcbi8vICAgICB9XHJcbiAgIFxyXG4vLyAgICAgZ2V0VXNlckluZm8oKSB7XHJcbi8vICAgICAgICAgcmV0dXJuIHtcclxuLy8gICAgICAgICBuYW1lOiB0aGlzLl9pbnB1dE5hbWUudmFsdWUgPSB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCxcclxuLy8gICAgICAgICB0ZXh0OiB0aGlzLl9pbnB1dFRleHQudmFsdWUgPSB0aGlzLl9wcm9maWxlVGV4dC50ZXh0Q29udGVudFxyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH1cclxuLy8gICAgIC8vIHNlclVzZXJJbmZvKG5hbWUsIHRleHQpIHtcclxuLy8gICAgIC8vICAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWVcclxuLy8gICAgIC8vICAgICB0aGlzLl9wcm9maWxlVGV4dC50ZXh0Q29udGVudCA9IHRleHRcclxuLy8gICAgIC8vICB9XHJcbi8vICAgICBzZXRVc2VySW5mbygpIHtcclxuXHJcbi8vICAgICAgICAgdGhpcy5faW5wdXROYW1lLnRleHRDb250ZW50ID0gdGhpcy5fcHJvZmlsZU5hbWUudmFsdWUsXHJcbi8vICAgICAgICAgdGhpcy5faW5wdXRUZXh0LnRleHRDb250ZW50ID0gdGhpcy5fcHJvZmlsZVRleHQudmFsdWVcclxuXHJcbi8vICAgICB9XHJcbi8vIH0iLCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgIC8vICB0aGlzLl9pbml0aWFsQXJyYXkgPSBkYXRhO1xyXG4gICAgICAgLy8gdGhpcy5faXRlbXM9IGl0ZW1zO1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTsgXHJcbiAgICB9XHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgIC8vdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KVxyXG4gICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudClcclxuICAgIH1cclxuICAgIHJlbmRlckl0ZW1zKGRhdGEpIHtcclxuICAgIC8vcmVuZGVyZXIoKSB7XHJcbiAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyKGl0ZW0pXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJsaW5rIiwiaGFuZGxlQ2FyZENsaWNrIiwidGVtcGxhdGVTZWxlY3RvciIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwiX2VsZW1lbnQiLCJ0ZXh0Q29udGVudCIsIl9pbWFnZSIsImFsdCIsInNyYyIsIl9kZXRldGUiLCJfYnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VDYXJkIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2RlbGV0ZUNhcmQiLCJyZW1vdmUiLCJvcGVuSW1nIiwiYWRkRXZlbnRMaXN0ZW5lciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJfcG9wdXBDbG9zZUJ1dHRvbiIsIm9wZW4iLCJhZGQiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdEFkZCIsInN1cGVyIiwiX2Zvcm0iLCJfaW5wdXQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2Zvcm1CdXR0b24iLCJyZXNldCIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsImZvckVhY2giLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRzVmFsdWVzIiwiZGF0YVVzZXIiLCJfb25TdWJtaXQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJfc3VibWl0QnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsImJ1dHRvbiIsInJlbW92ZUF0dHJpYnV0ZSIsImRpc2FibGVCdXR0b24iLCJzZXRBdHRyaWJ1dGUiLCJfc2hvd0lucHV0RXJyb3IiLCJmb3JtRXJyb3IiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImZvcm1JbnB1dCIsInNvbWUiLCJpdGVtIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJjaGVja1ZhbGlkaXR5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dEVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwiYXBpIiwib3B0aW9ucyIsIl91cmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2F1dGhvcml6YXRpb24iLCJhdXRob3JpemF0aW9uIiwiZ2V0SW5pdGlhbENhcmRzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5mbyIsImZldGNoIiwidGhlbiIsImdldENhcmQiLCJwb3B1cEVkaXRFbGVtZW50IiwicG9wdXBBZGRFbGVtZW50IiwicG9wdXBPcGVuSW1hZ2VFbGVtZW50IiwicHJvZmlsZUJ1dHRvbkVsZW1lbnQiLCJwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQiLCJwcm9maWxlQWRkQnV0dG9uRWxlbWVudCIsImZvcm1FbGVtZW50RWRpdCIsImZvcm1FbGVtZW50QWRkIiwicG9wdXBPcGVuSW1hZ2VTZWN0aW9uIiwiX3RleHQiLCJ0aXRsZSIsInVzZXJJbmZvIiwiX3Byb2ZpbGVOYW1lIiwibmFtZVNlbGVjdG9yIiwiX3Byb2ZpbGVUZXh0Iiwiam9iU2VsZWN0b3IiLCJfcHJvZmlsZUF2YXRhciIsImF2YXRhclNlbGVjdG9yIiwiZ2V0VXNlckluZm8iLCJmaXJzdG5hbWUiLCJkZXNjcmlwdGlvbiIsInNlclVzZXJJbmZvIiwiYXZhdGFyIiwiZWRpdFBvcHVwV2l0aEZvcm0iLCJjb25zb2xlIiwibG9nIiwiYWRkdFBvcHVwV2l0aEZvcm0iLCJjYXJkc0xpc3RTZWN0aW9uIiwiYWRkSXRlbSIsImNyZWF0ZUNhcmQiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX2NvbnRhaW5lciIsImVsZW1lbnQiLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJkYXRhIiwiZm9ybUVkaXRWYWxpZGF0b3IiLCJmb3JtQWRkVmFsaWRhdG9yIiwiYWxsIiwiZGF0YUNhcmQiLCJteWlkIiwiX2lkIiwiYWJvdXQiXSwic291cmNlUm9vdCI6IiJ9