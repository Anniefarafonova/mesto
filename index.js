(()=>{"use strict";class t{constructor(t,e,s,o,i){this.card=t,this._name=t.name,this._link=t.link,this._myid=t.myid,this._cardId=t._id,this._likes=t.likes,this._likesLength=t.likes.length,this._putLike=i,this._ownerId=t.owner._id,this._openConfirm=o,this._templateSelector=s,this.handleCardClick=e}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_visibleDeleteButton(){this._myid===this._ownerId?this._delete.style.visibility="visible":this._myid!==this._ownerId&&(this._delete.style.visibility="hidden")}_countLike(){this._likes.forEach((t=>{t._id!==this._myid?this._counter.textContent=this._likesLength:this._button.classList.add("element__like-button_active")}))}generateCard(){return this._element=this._getTemplate(),this._counter=this._element.querySelector(".element__like-count"),this._delete=this._element.querySelector(".element__delete"),this._button=this._element.querySelector(".element__like-button"),this._image=this._element.querySelector(".element__image"),this._text=this._element.querySelector(".element__title"),this._text.textContent=this._name,this._image.alt=this._name,this._image.src=this._link,this._countLike(),this._visibleDeleteButton(),this._setEventListeners(),this._element}_likeCard(){this._putLike(this._button,this._cardId)}toggleLike(t){this._button.classList.toggle("element__like-button_active"),this._counter.textContent=t.length}deleteButtonCard(){this._element.remove(),this._element=null}getId(){return this._cardId}openImg(){this.handleCardClick(this._name,this._link)}_handleOpenDelete(){this._openConfirm({card:this,cardID:this._cardID})}_setEventListeners(){this._button.addEventListener("click",(()=>{this._likeCard()})),this._image.addEventListener("click",(()=>{this.openImg()})),this._delete.addEventListener("click",(()=>{this._handleOpenDelete()}))}}class e{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._popupCloseButton=this._popup.querySelector(".popup__close")}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(t=>{t.target===t.currentTarget&&this.close()})),this._popupCloseButton.addEventListener("click",(()=>{this.close()}))}}class s extends e{constructor(t,e){super(t),this.formSubmitAdd=e,this._form=this._popup.querySelector(".form"),this._input=this._popup.querySelectorAll(".form__item"),console.log(this._input),this._popupButton=this._popup.querySelector(".popup__saved-button"),this._popupButtonLoading=this._popupButton.textContent}close(){super.close(),this._form.reset()}_getInputValues(){return this.values={},this._input.forEach((t=>{this.values[t.name]=t.value})),this.values}setInputsValues(t){this._input.forEach((e=>{e.value=t[e.name]}))}_onSubmit=t=>{t.preventDefault(),this._popupButton.textContent=`${this._popupButton.textContent}...`,this.formSubmitAdd(this._getInputValues())};setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this._onSubmit)}setButtonText(){this._popupButton.textContent=this._popupButtonLoading}}const o={formSelector:".form",inputSelector:".form__item",submitButtonSelector:".popup__saved-button",inactiveButtonClass:"popup__saved-button_disabled",inputErrorClass:"form__item-error",errorClass:"error_opened"};class i{constructor(t,e){this.formSelector=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=Array.from(this.formSelector.querySelectorAll(this._inputSelector)),this._submitButton=this.formSelector.querySelector(this._submitButtonSelector)}_enableButton(t){t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled")}disableButton(t){t.classList.add(this._inactiveButtonClass),t.setAttribute("disabled",!0)}_showInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}_hideInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}_hasInvalidInput(t){return t.some((t=>!t.validity.valid))}_checkInputValidity(t){t.checkValidity()?this._hideInputError(t):this._showInputError(t)}setEventListeners(){this.disableButton(this._submitButton),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this.toggleButtonState(),this._checkInputValidity(t)}))}))}toggleButtonState(){this._hasInvalidInput(this._inputList)?this.disableButton(this._submitButton):this._enableButton(this._submitButton)}resetValidation(){this.toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}enableValidation(){this.setEventListeners()}}const n=document.querySelector(".popup_type_edit"),r=document.querySelector(".popup_type_add"),a=(document.querySelector(".popup_type_image"),document.querySelector(".popup_type_confirm"),document.querySelector(".popup_type_avatar")),l=document.querySelector(".profile"),u=l.querySelector(".profile__edit-button"),h=l.querySelector(".profile__add-button"),c=document.querySelector(".profile__avatar-button"),_=n.querySelector(".form"),p=r.querySelector(".form"),d=a.querySelector(".form"),m=new class{constructor(t){this._url=t.baseUrl,this._headers=t.headers,this._authorization=t.headers.authorization}_checkResponse(t){return t.ok?t.json():Promise.reject(`Что-то пошло не так: ${t.status}`)}getInfo(){return fetch(`${this._url}/users/me`,{headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._checkResponse)}getCard(){return fetch(`${this._url}/cards`,{headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._checkResponse)}setUserInfo(t){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t.firstname,about:t.description})}).then(this._checkResponse)}setUserAvatar(t){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t.avatar})}).then(this._checkResponse)}addCard(t){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t.title,link:t.link})}).then(this._checkResponse)}addLike(t){return fetch(`${this._url}/cards/${t}/likes`,{method:"PUT",headers:{authorization:this._authorization}}).then(this._checkResponse)}deleteLike(t){return fetch(`${this._url}/cards/${t}/likes`,{method:"DELETE",headers:{authorization:this._authorization}}).then(this._checkResponse)}deleteCard(t){return fetch(`${this._url}/cards/${t}`,{method:"DELETE",headers:{authorization:this._authorization}}).then(this._checkResponse)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-66",headers:{authorization:"26786be3-fed9-4d83-9ae2-1348eee1b7d5","Content-Type":"application/json"}});let f;const v=new class extends e{constructor(t){super(t),this._image=this._popup.querySelector(".popup__image"),this._text=this._popup.querySelector(".popup__text")}open=(t,e)=>{this._text.textContent=t,this._image.alt=t,this._image.src=e,super.open()}}(".popup_type_image");v.setEventListeners();const y=new class{constructor(t){this._profileName=document.querySelector(t.nameSelector),this._profileText=document.querySelector(t.jobSelector),this._profileAvatar=document.querySelector(t.avatarSelector)}getUserInfo(){return{firstname:this._profileName.textContent,description:this._profileText.textContent}}serUserInfo({avatar:t,firstname:e,description:s}){this._profileAvatar.src=t,this._profileName.textContent=e,this._profileText.textContent=s}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__avatar"}),g=new s(".popup_type_edit",(function(t){m.setUserInfo(t).then((t=>{const e={avatar:t.avatar,firstname:t.name,description:t.about};y.serUserInfo(e),g.close()})).catch((t=>console.error(`Ошибка при редактировании ${t}`))).finally((()=>g.setButtonText()))}));g.setEventListeners(),u.addEventListener("click",(function(){g.setInputsValues(y.getUserInfo()),console.log(y.getUserInfo()),g.open()}));const S=new s(".popup_type_add",(function(t){console.log("open"),p.reset(),B.resetValidation(),Promise.all([m.getInfo(),m.addCard(t)]).then((([t,e])=>{console.log(e),f=t._id,e.myid=f,k.addItem(L(e)),S.close()})).catch((t=>console.error(`Ошибка при создании карточки ${t}`))).finally((()=>S.setButtonText()))}));S.setEventListeners(),h.addEventListener("click",(function(){S.open(),B.resetValidation()}));const b=new s(".popup_type_avatar",(function(t){d.reset(),I.resetValidation(),m.setUserAvatar(t).then((t=>{console.log(t),y.serUserInfo({avatar:t.avatar,firstname:t.name,description:t.about}),b.close()})).catch((t=>console.error(`Ошибка при редактировании аватара ${t}`))).finally((()=>b.setEventListeners()))}));b.setEventListeners(),console.log(c),c.addEventListener("click",(function(){b.open()}));const C=new class extends e{constructor(t,e){super(t),this.formSubmit=e,this.popupButton=this._popup.querySelector(".popup__saved-button"),this.popupButtonLoading=this.popupButton.textContent}_submit=t=>{t.preventDefault(),this.popupButton.textContent=`${this.popupButton.textContent}...`,this.formSubmit({card:this._element,cardID:this._cardID})};setEventListeners(){super.setEventListeners(),this.popupButton.addEventListener("click",this._submit)}setSubmitHanlder(t){this.formSubmit=t}setButtonText(){this.popupButton.textContent=this.popupButtonLoading}open=(t,e)=>{super.open(),this._element=t,this._cardID=e}}(".popup_type_confirm",(function({card:t,cardId:e}){console.log("x"),m.deleteCard(e).then((e=>{console.log(e),t.deleteButtonCard(),C.setButtonText(е)})).catch((t=>console.error(`Ошибка при удалении карточки ${t}`))).finally((()=>C.setButtonText()))}));function L(e){const s=new t(e,v.open,".elements-template",(()=>{const t=s.getId();console.log(t),console.log("x"),C.open(),C.setSubmitHanlder((()=>{m.deleteCard(t).then((()=>{s.deleteButtonCard(),C.close()}))}))}),((t,e)=>{t.classList.contains("element__like-button_active")?m.deleteLike(e).then((t=>{console.log(t),s.toggleLike(t.likes)})).catch((t=>console.error(`Ошибка при удалении лайка ${t}`))):m.addLike(e).then((t=>{console.log(t),s.toggleLike(t.likes)})).catch((t=>console.error(`Ошибка при поставк лайка ${t}`)))}));return s.generateCard()}C.setEventListeners(),C.setSubmitHanlder();const k=new class{constructor(t,e){this.renderer=t,this._container=document.querySelector(e)}addItem(t){this._container.prepend(t)}renderItems(t){t.forEach((t=>{this.renderer(t)}))}}((t=>{k.addItem(L(t))}),".elements__list-template"),E=new i(o,_),B=new i(o,p),I=new i(o,d);E.enableValidation(),B.enableValidation(),I.enableValidation(),Promise.all([m.getInfo(),m.getCard()]).then((([t,e])=>{console.log(e),f=t._id,console.log(f),e.forEach((t=>{t.myid=f})),console.log(t),y.serUserInfo({avatar:t.avatar,firstname:t.name,description:t.about}),k.renderItems(e.reverse())})).catch((t=>console.error(`Ошибка при начальных данный страницы ${t}`)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bEJpRSxRQUFRQyxJQUFJbUcsR0FDWm1CLEVBQVNwSyxTQUFRQyxJQUNiQSxFQUFRdkIsS0FBT3VLLENBQU0sSUFFekJwRyxRQUFRQyxJQUFJUyxHQUNaNEYsRUFBU1EsWUFBWSxDQUFFakIsT0FBUW5GLEVBQVNtRixPQUFRSixVQUFXL0UsRUFBU2pGLEtBQU1rSyxZQUFhakYsRUFBU2dGLFFBQ2hHOEIsRUFBaUJvQixZQUFZckIsRUFBU3VCLFVBQVUsSUFHbkQ3QixPQUFPQyxHQUFVbEgsUUFBUWtILE1BQU8sd0NBQXVDQSxNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKGRhdGEsIGhhbmRsZUNhcmRDbGljaywgdGVtcGxhdGVTZWxlY3Rvciwgb3BlbkNvbmZpcm0sIHB1dExpa2UpIHtcclxuICAgICAgICB0aGlzLmNhcmQgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgICAgICB0aGlzLl9teWlkID0gZGF0YS5teWlkO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJZCA9IGRhdGEuX2lkXHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzTGVuZ3RoID0gZGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICAgICAgdGhpcy5fcHV0TGlrZSA9IHB1dExpa2U7XHJcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gICAgICAgIHRoaXMuX29wZW5Db25maXJtID0gb3BlbkNvbmZpcm1cclxuICAgICAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLmhhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuXHJcbiAgICB9XHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgICAgLy8g0LfQsNCx0LjRgNCw0LXQvCDRgNCw0LfQvNC10YLQutGDINC40LcgSFRNTCDQuCDQutC70L7QvdC40YDRg9C10Lwg0Y3Qu9C10LzQtdC90YJcclxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXHJcbiAgICAgICAgICAgIC5jb250ZW50XHJcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudCcpXHJcbiAgICAgICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gICAgfVxyXG4gICAgX3Zpc2libGVEZWxldGVCdXR0b24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX215aWQgPT09IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGVsZXRlLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSdcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX215aWQgIT09IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGVsZXRlLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJ1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9jb3VudExpa2UoKSB7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuX2lkID09PSB0aGlzLl9teWlkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9idXR0b24uY2xhc3NMaXN0LmFkZCgnZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlJylcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2NvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlc0xlbmd0aFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgICAgICB0aGlzLl9jb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZS1jb3VudCcpXHJcbiAgICAgICAgdGhpcy5fZGVsZXRlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fZGVsZXRlJylcclxuICAgICAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlLWJ1dHRvbicpXHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pbWFnZScpXHJcbiAgICAgICAgdGhpcy5fdGV4dCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX3RpdGxlJylcclxuICAgICAgICB0aGlzLl90ZXh0LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICB0aGlzLl9pbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICAgICAgdGhpcy5fY291bnRMaWtlKClcclxuICAgICAgICB0aGlzLl92aXNpYmxlRGVsZXRlQnV0dG9uKClcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0KTRg9C90LrRhtC40Y8g0LvQsNC50LrQsFxyXG4gICAgX2xpa2VDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX3B1dExpa2UodGhpcy5fYnV0dG9uLCB0aGlzLl9jYXJkSWQpXHJcbiAgICAgICAgLy8gdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2VsZW1lbnRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpXHJcbiAgICB9O1xyXG4gICAgdG9nZ2xlTGlrZShsaWtlcykge1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmUnKVxyXG4gICAgICAgIHRoaXMuX2NvdW50ZXIudGV4dENvbnRlbnQgPSBsaWtlcy5sZW5ndGhcclxuICAgIH1cclxuICAgIC8v0KTRg9C90LrRhtC40Y8g0YPQtNCw0LvQtdC90LjRj1xyXG4gICAgZGVsZXRlQnV0dG9uQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsXHJcblxyXG4gICAgfVxyXG4gICAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gIHRoaXMuX2NhcmRJZCBcclxuICAgIH1cclxuICAgIG9wZW5JbWcoKSB7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluaylcclxuICAgIH1cclxuICAgIF9oYW5kbGVPcGVuRGVsZXRlKCkge1xyXG4gICAgICAgIHRoaXMuX29wZW5Db25maXJtKHsgY2FyZDogdGhpcywgY2FyZElEOiB0aGlzLl9jYXJkSUQgfSlcclxuXHJcbiAgICB9XHJcbiAgICAvL9GB0LvRg9GI0LDRgtC10LvQuFxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIC8v0YHQu9GD0YjQsNGC0LXQu9GMINC70LDQudC60LBcclxuICAgICAgICB0aGlzLl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VDYXJkKClcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8v0YHQu9GD0YjQsNGC0LXQu9GMINGD0LTQsNC70Y/Qu9C60LhcclxuICAgICAgICAvLyB0aGlzLl9kZWxldGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbkNhcmQoKVxyXG4gICAgICAgIC8vIH0pXHJcbiAgICAgICAgLy/RgdC70YPRiNCw0YLQtdC70Ywg0L7RgtC60YDRi9GC0LjRjyDQutCw0YDRgtC40L3QutC4XHJcbiAgICAgICAgdGhpcy5faW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub3BlbkltZygpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gLy/RgdC70YPRiNCw0YLQtdC70YwgXHJcbiAgICAgICAgdGhpcy5fZGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVPcGVuRGVsZXRlKClcclxuXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICAvL3RoaXMuX3BvcHVwID0gcG9wdXBTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy/QntGC0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8vL1xyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpXHJcblxyXG4gICAgfVxyXG4gICAgLy/Ql9Cw0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8vL1xyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKVxyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKVxyXG4gICAgfVxyXG4gICAgLy/Ql9Cw0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8gRXNjLy9cclxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvL9Ch0LvRg9GI0LDRgtC10LvRjCDQt9Cw0LrRgNGL0YLQuNGPLCDQvdCw0LbQuNC80LDRjyDQvdCwINGC0LXQvNC9LtGN0LrRgNCw0L0g0Lgg0LfQsNC60YDRi9GC0LjQtSDQvdCwINC60L3QvtC/0LrRgyDQutGA0LXRgdGC0LjQui8vXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldClcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgZm9ybVN1Ym1pdEFkZCkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuZm9ybVN1Ym1pdEFkZCA9IGZvcm1TdWJtaXRBZGQ7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XHJcbiAgICAgICAgdGhpcy5faW5wdXQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybV9faXRlbScpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuX2lucHV0KTtcclxuICAgICAgICB0aGlzLl9wb3B1cEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZWQtYnV0dG9uJyk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBCdXR0b25Mb2FkaW5nID0gdGhpcy5fcG9wdXBCdXR0b24udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgfVxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKVxyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICB0aGlzLnZhbHVlcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2lucHV0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXM7XHJcbiAgICB9XHJcbiAgICBzZXRJbnB1dHNWYWx1ZXMoZGF0YVVzZXIpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IGRhdGFVc2VyW2lucHV0Lm5hbWVdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblN1Ym1pdCA9IChldnQpID0+IHtcclxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IGAke3RoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50fS4uLmA7XHJcbiAgICAgICAgdGhpcy5mb3JtU3VibWl0QWRkKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9vblN1Ym1pdClcclxuICAgIH1cclxuXHJcbiAgICBzZXRCdXR0b25UZXh0KCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50ID0gIHRoaXMuX3BvcHVwQnV0dG9uTG9hZGluZ1xyXG4gICBcclxuICAgIH1cclxuXHJcblxyXG59XHJcblxyXG5cclxuXHJcblxyXG4iLCJleHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9ICh7XHJcbiAgICBmb3JtU2VsZWN0b3I6ICcuZm9ybScsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiAnLmZvcm1fX2l0ZW0nLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3NhdmVkLWJ1dHRvbicsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX3NhdmVkLWJ1dHRvbl9kaXNhYmxlZCcsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6ICdmb3JtX19pdGVtLWVycm9yJyxcclxuICAgIGVycm9yQ2xhc3M6ICdlcnJvcl9vcGVuZWQnXHJcbn0pO1xyXG5cclxuZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtKSB7XHJcbiAgICAgICAgdGhpcy5mb3JtU2VsZWN0b3IgPSBmb3JtLFxyXG4gICAgICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3IsXHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yLFxyXG4gICAgICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MsXHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MsXHJcbiAgICAgICAgICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcyxcclxuXHJcbiAgICAgICAgICAgIC8vdGhpcy5fZm9ybSA9IEFycmF5LmZyb20odGhpcy5mb3JtU2VsZWN0b3IucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSlcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLl9mb3JtKVxyXG4gICAgICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuZm9ybVNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpXHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5mb3JtU2VsZWN0b3IucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvcilcclxuICAgIH1cclxuXHJcbiAgICAvLyDQutC90L7Qv9C60LAg0LDQutGC0LjQslxyXG4gICAgX2VuYWJsZUJ1dHRvbihidXR0b24pIHtcclxuICAgICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKVxyXG4gICAgICAgIGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKVxyXG4gICAgfVxyXG4gICAgLy8g0LrQvdC+0L/QutCwINC90LXQsNC60YLQuNCyXHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbikge1xyXG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpXHJcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpXHJcbiAgICB9XHJcblxyXG4gICAgLy8g0KTRg9C90LrRhtC40Y8gINC/0L7Qu9GPIGMg0L7RiNC40LHQutC+0LlcclxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dCkge1xyXG4gICAgICAgIGNvbnN0IGZvcm1FcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBmb3JtRXJyb3IudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZVxyXG4gICAgICAgIGZvcm1FcnJvci5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyAgLy8g0KTRg9C90LrRhtC40Y8gINC/0L7Qu9GPINCx0LXQtyDQvtGI0LjQsdC60LhcclxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dCkge1xyXG4gICAgICAgIGNvbnN0IGZvcm1FcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBmb3JtRXJyb3IudGV4dENvbnRlbnQgPSBcIlwiXHJcbiAgICAgICAgZm9ybUVycm9yLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIF9oYXNJbnZhbGlkSW5wdXQoZm9ybUlucHV0KSB7XHJcbiAgICAgICAgcmV0dXJuIGZvcm1JbnB1dC5zb21lKGl0ZW0gPT4gIWl0ZW0udmFsaWRpdHkudmFsaWQpXHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkge1xyXG4gICAgICAgIGlmIChpbnB1dC5jaGVja1ZhbGlkaXR5KCkpIHtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gLy/RhNGD0L3QutGG0LjRjyDRgdC70YPRiNCw0YLQtdC70LXQuVxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbilcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dClcclxuICAgICAgICAgICAgLy8gICAgICAgICAvLyBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAvLyAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbih0aGlzLl9zdWJtaXRCdXR0b24pXHJcbiAgICAgICAgICAgIC8vICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAvLyAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbilcclxuICAgICAgICAgICAgLy8gICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgIH07XHJcbiAgICB0b2dnbGVCdXR0b25TdGF0ZSgpe1xyXG4gICAgXHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbih0aGlzLl9zdWJtaXRCdXR0b24pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgKHRoaXMuX2VuYWJsZUJ1dHRvbigodGhpcy5fc3VibWl0QnV0dG9uKSkpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpOyBcclxuICBcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpXHJcbiAgICAgICAgfSk7XHJcbiAgXHJcbiAgICAgIH1cclxuICAgIC8vICAgLy/RhNGD0L3QutGG0LjRjyDQt9Cw0L/Rg9GB0LrQsCDQstGL0LvQuNC00LDRhtC40LhcclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpXHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfQodCw0YXQsNC70LjQvScsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vbGl2ZS5zdGF0aWNmbGlja3IuY29tLzY1NTM1LzUxNjY0MzEzNzA1XzU3MTM3OTEyNTdfay5qcGcnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIHRpdGxlOiAn0JTQsNCz0LXRgdGC0LDQvScsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vbGl2ZS5zdGF0aWNmbGlja3IuY29tLzE5NTgvNDQzNjg5NzgzMDRfMjczMmI1ODMyNV9rLmpwZydcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfQmNCy0LDQvdC+0LLQvicsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9pdmFub3ZvLmpwZydcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfQmtCw0LzRh9Cw0YLQutCwJyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9saXZlLnN0YXRpY2ZsaWNrci5jb20vNjU1MzUvNDg4MjAxMDA1MzJfODdhMWNlYjEwZF9rLmpwZydcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfQpdC+0LvQvNC+0LPQvtGA0YHQutC40Lkg0YDQsNC50L7QvScsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9raG9sbW9nb3Jza3ktcmF5b24uanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9CR0LDQudC60LDQuycsXHJcbiAgICAgICAgbGluazogJ2h0dHBzOi8vbGl2ZS5zdGF0aWNmbGlja3IuY29tLzY1NTM1LzUxNDIxMjA1NDM0Xzg5MTNmNGExYTVfay5qcGcnXHJcbiAgICB9XHJcbl07XHJcblxyXG4vLyDQndCw0YXQvtC00LjQvCBwb3B1cFxyXG5jb25zdCBwb3B1cEVkaXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2VkaXRcIik7XHJcbmNvbnN0IHBvcHVwRWRpdEVsZW1lbnRTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfZWRpdFwiXHJcbmNvbnN0IHBvcHVwQWRkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGRcIik7XHJcbmNvbnN0IHBvcHVwQWRkRWxlbWVudFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9hZGRcIlxyXG5cclxuY29uc3QgcG9wdXBPcGVuSW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2ltYWdlXCIpO1xyXG5jb25zdCBwb3B1cE9wZW5JbWFnZUVsZW1lbnRTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfaW1hZ2VcIlxyXG5jb25zdCBwb3B1cENsb3NlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2NvbmZpcm0nKVxyXG5jb25zdCBwb3B1cENvbmZpcm1FbGVtZW50U2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2NvbmZpcm1cIlxyXG5jb25zdCBwb3B1cEF2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hdmF0YXInKVxyXG5jb25zdCBwb3B1cEF2YXRhckVsZW1lbnRTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfYXZhdGFyXCJcclxuXHJcbi8vINCd0LDRhdC+0LTQuNC8INC60L3QvtC/0LrQuFxyXG5jb25zdCBwcm9maWxlQnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZVwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b25FbGVtZW50ID0gcHJvZmlsZUJ1dHRvbkVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnQgPSBwcm9maWxlQnV0dG9uRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXItYnV0dG9uJylcclxuXHJcblxyXG5cclxuLy8g0J3QsNGF0L7QtNC40Lwg0L/QvtC70Y8g0YTQvtGA0LzRiyDQsiBET01cclxuY29uc3QgZm9ybUVsZW1lbnRFZGl0ID0gcG9wdXBFZGl0RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50QWRkID0gcG9wdXBBZGRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuY29uc3QgZm9ybUVsZW1lbnRBdmF0YXIgPSBwb3B1cEF2YXRhckVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG5cclxuZXhwb3J0IHsgcG9wdXBFZGl0RWxlbWVudCwgcG9wdXBFZGl0RWxlbWVudFNlbGVjdG9yLCBwb3B1cEFkZEVsZW1lbnQsIHBvcHVwQWRkRWxlbWVudFNlbGVjdG9yLCBwb3B1cE9wZW5JbWFnZUVsZW1lbnQsIHBvcHVwT3BlbkltYWdlRWxlbWVudFNlbGVjdG9yLCBwb3B1cENsb3NlRWxlbWVudCwgcG9wdXBDb25maXJtRWxlbWVudFNlbGVjdG9yLCBwb3B1cEF2YXRhckVsZW1lbnQsIHBvcHVwQXZhdGFyRWxlbWVudFNlbGVjdG9yLCBwcm9maWxlQnV0dG9uRWxlbWVudCwgcHJvZmlsZUVkaXRCdXR0b25FbGVtZW50LCBwcm9maWxlQWRkQnV0dG9uRWxlbWVudCwgYXZhdGFyQnV0dG9uLCBmb3JtRWxlbWVudEVkaXQsIGZvcm1FbGVtZW50QWRkLCBmb3JtRWxlbWVudEF2YXRhciB9IiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gJy4uL2NvbXBvbmVudHMvU2VjdGlvbi5qcydcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMnXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcydcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnXHJcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnXHJcbmltcG9ydCBQb3B1cFdpdGhEZWxldGUgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanMnXHJcblxyXG5pbXBvcnQgeyB2YWxpZGF0aW9uQ29uZmlnIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJ1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJ1xyXG5pbXBvcnQgJy4vaW5kZXguY3NzJ1xyXG5cclxuaW1wb3J0IHsgcG9wdXBFZGl0RWxlbWVudCwgcG9wdXBFZGl0RWxlbWVudFNlbGVjdG9yLCBwb3B1cEFkZEVsZW1lbnQsIHBvcHVwQWRkRWxlbWVudFNlbGVjdG9yLCBwb3B1cE9wZW5JbWFnZUVsZW1lbnQsIHBvcHVwT3BlbkltYWdlRWxlbWVudFNlbGVjdG9yLCBwb3B1cENsb3NlRWxlbWVudCwgcG9wdXBDb25maXJtRWxlbWVudFNlbGVjdG9yLCBwb3B1cEF2YXRhckVsZW1lbnQsIHBvcHVwQXZhdGFyRWxlbWVudFNlbGVjdG9yLCBwcm9maWxlQnV0dG9uRWxlbWVudCwgcHJvZmlsZUVkaXRCdXR0b25FbGVtZW50LCBwcm9maWxlQWRkQnV0dG9uRWxlbWVudCwgYXZhdGFyQnV0dG9uLCBmb3JtRWxlbWVudEVkaXQsIGZvcm1FbGVtZW50QWRkLCBmb3JtRWxlbWVudEF2YXRhciB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcydcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/Qn9C+0LTQutGO0YcuINC6INGB0LXRgNCy0LXRgNGDLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICAgIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTY2JyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiAnMjY3ODZiZTMtZmVkOS00ZDgzLTlhZTItMTM0OGVlZTFiN2Q1JyxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9XHJcbn0pO1xyXG5sZXQgdXNlcklkO1xyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/Qn9C+0L/QsNC/INC+0YLQutGA0YvRgtC40Y8g0LrQsNGA0YLQvtGH0LXQui8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbmNvbnN0IHBvcHVwT3BlbkltYWdlU2VjdGlvbiA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cE9wZW5JbWFnZUVsZW1lbnRTZWxlY3RvcilcclxucG9wdXBPcGVuSW1hZ2VTZWN0aW9uLnNldEV2ZW50TGlzdGVuZXJzKClcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vL9Cf0L7Qv9Cw0L8gRURJVFxyXG5jb25zdCBjb25maWcgPSB7XHJcbiAgICBuYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9fdGl0bGUnLFxyXG4gICAgam9iU2VsZWN0b3I6ICcucHJvZmlsZV9fc3VidGl0bGUnLFxyXG4gICAgYXZhdGFyU2VsZWN0b3I6ICcucHJvZmlsZV9fYXZhdGFyJ1xyXG59XHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKGNvbmZpZyk7XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/Qn9C+0L/QsNC/IEVESVQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbmNvbnN0IGVkaXRQb3B1cFdpdGhGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBFZGl0RWxlbWVudFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0RWRpdClcclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdEVkaXQoZGF0YSkge1xyXG4gICAgYXBpLnNldFVzZXJJbmZvKGRhdGEpXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlckluZm9BbGwgPSB7IGF2YXRhcjogcmVzLmF2YXRhciwgZmlyc3RuYW1lOiByZXMubmFtZSwgZGVzY3JpcHRpb246IHJlcy5hYm91dCB9XHJcbiAgICAgICAgICAgIHVzZXJJbmZvLnNlclVzZXJJbmZvKHVzZXJJbmZvQWxsKVxyXG4gICAgICAgICAgICBlZGl0UG9wdXBXaXRoRm9ybS5jbG9zZSgpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoYNCe0YjQuNCx0LrQsCDQv9GA0Lgg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjQuCAke2Vycm9yfWApKSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiBlZGl0UG9wdXBXaXRoRm9ybS5zZXRCdXR0b25UZXh0KCkpXHJcblxyXG59XHJcbmVkaXRQb3B1cFdpdGhGb3JtLnNldEV2ZW50TGlzdGVuZXJzKClcclxuLy8v0JjQutC+0L3QutCwIEVESVQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbnByb2ZpbGVFZGl0QnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHByb2ZpbGVFZGl0QnV0dG9uRWxlbWVudEZ1bmN0aW9uKTtcclxuZnVuY3Rpb24gcHJvZmlsZUVkaXRCdXR0b25FbGVtZW50RnVuY3Rpb24oKSB7XHJcbiAgICBlZGl0UG9wdXBXaXRoRm9ybS5zZXRJbnB1dHNWYWx1ZXModXNlckluZm8uZ2V0VXNlckluZm8oKSlcclxuICAgIGNvbnNvbGUubG9nKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xyXG4gICAgZWRpdFBvcHVwV2l0aEZvcm0ub3BlbigpXHJcbn1cclxuLy8gZnVuY3Rpb24gcHJvZmlsZUVkaXRCdXR0b25FbGVtZW50RnVuY3Rpb24oKSB7XHJcbi8vICAgICBlZGl0UG9wdXBXaXRoRm9ybS5vcGVuKClcclxuLy8gICAgIGNvbnN0IHByb2ZpbGVEYXRhICA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCkgLy8g0JLQvtGCINGC0YPRgiDQsiDQv9C10YDQtdC80LXQvdC90YPRjiBwcm9maWxlRGF0YSDQv9C+0LvQvtC20LjQu9C4INC+0LHRitC10LrRgiwg0YLQvtGCINGH0YLQviDRgtGLINC60L7QvdGB0L7Qu9GM0LvQvtCz0LjRgNGD0LXRiNGMINC90LAg0YHQutGA0LjQvdGI0L7RgtC1IFxyXG4vLyAgIGNvbnNvbGUubG9nKHByb2ZpbGVEYXRhKTtcclxuLy8gICAgIG5hbWVFZGl0SW5wdXQudmFsdWUgPSBwcm9maWxlRGF0YS5maXJzdG5hbWVcclxuLy8gICAgIGpvYkVkaXRJbnB1dC52YWx1ZSA9IHByb2ZpbGVEYXRhLmRlc2NyaXB0aW9uXHJcbi8vICAgfVxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0J/QvtC/0LDQvyBBRC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmNvbnN0IGFkZHRQb3B1cFdpdGhGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBBZGRFbGVtZW50U2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXRBZGQpXHJcbmZ1bmN0aW9uIGhhbmRsZUZvcm1TdWJtaXRBZGQoZGF0YSkge1xyXG4gICAgY29uc29sZS5sb2coJ29wZW4nKTtcclxuICAgIGZvcm1FbGVtZW50QWRkLnJlc2V0KCk7XHJcbiAgICBmb3JtQWRkVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpXHJcbiAgICBQcm9taXNlLmFsbChbYXBpLmdldEluZm8oKSwgYXBpLmFkZENhcmQoZGF0YSldKVxyXG4gICAgICAgIC50aGVuKChbZGF0YVVzZXIsIGRhdGFDYXJkXSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhQ2FyZCk7XHJcbiAgICAgICAgICAgIHVzZXJJZCA9IGRhdGFVc2VyLl9pZCAgXHJcbiAgICAgICAgICAgIGRhdGFDYXJkLm15aWQgPSB1c2VySWRcclxuICAgICAgICAgICAgLy8gZGF0YUNhcmQubXlpZCA9IGRhdGFVc2VyLl9pZFxyXG4gICAgICAgICAgICBjYXJkc0xpc3RTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhQ2FyZCkpO1xyXG4gICAgICAgICAgICBhZGR0UG9wdXBXaXRoRm9ybS5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnJvciA9PiBjb25zb2xlLmVycm9yKGDQntGI0LjQsdC60LAg0L/RgNC4INGB0L7Qt9C00LDQvdC40Lgg0LrQsNGA0YLQvtGH0LrQuCAke2Vycm9yfWApKSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiBhZGR0UG9wdXBXaXRoRm9ybS5zZXRCdXR0b25UZXh0KCkpXHJcbn07XHJcbmFkZHRQb3B1cFdpdGhGb3JtLnNldEV2ZW50TGlzdGVuZXJzKClcclxuLy8v0JjQutC+0L3QutCwIEFERC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxucHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwcm9maWxlQWRkQnV0dG9uRWxlbWVudEZ1bmN0aW9uKTtcclxuZnVuY3Rpb24gcHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnRGdW5jdGlvbigpIHtcclxuICAgIGFkZHRQb3B1cFdpdGhGb3JtLm9wZW4oKVxyXG4gICAgZm9ybUFkZFZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKVxyXG59XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0J/QvtC/0LDQvyBBVkFUQVIvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cEF2YXRhckVsZW1lbnRTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdEF2YXRhcilcclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdEF2YXRhcihkYXRhKSB7XHJcbiAgICBmb3JtRWxlbWVudEF2YXRhci5yZXNldCgpO1xyXG4gICAgZm9ybUF2YXRhclZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKVxyXG4gICAgYXBpLnNldFVzZXJBdmF0YXIoZGF0YSlcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICB1c2VySW5mby5zZXJVc2VySW5mbyh7IGF2YXRhcjogcmVzLmF2YXRhciwgZmlyc3RuYW1lOiByZXMubmFtZSwgZGVzY3JpcHRpb246IHJlcy5hYm91dCB9KVxyXG4gICAgICAgICAgIGF2YXRhclBvcHVwLmNsb3NlKClcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyb3IgPT4gY29uc29sZS5lcnJvcihg0J7RiNC40LHQutCwINC/0YDQuCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC4INCw0LLQsNGC0LDRgNCwICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgIC8vLmZpbmFsbHkoKCkgPT4gYXZhdGFyUG9wdXAuc2V0QnV0dG9uVGV4dCgpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IGF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCkpXHJcbn07XHJcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKClcclxuXHJcbmNvbnNvbGUubG9nKGF2YXRhckJ1dHRvbik7XHJcbi8vL9CY0LrQvtC90LrQsCBDTE9TRS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZm9ybSlcclxuZnVuY3Rpb24gZm9ybSgpIHtcclxuICAgIGF2YXRhclBvcHVwLm9wZW4oKVxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0J/QvtC/0LDQvyBDT05GSVJNLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5cclxuY29uc3QgcG9wdXBEZWxldGUgPSBuZXcgUG9wdXBXaXRoRGVsZXRlKHBvcHVwQ29uZmlybUVsZW1lbnRTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdENvbmZpcm0pXHJcbmZ1bmN0aW9uIGhhbmRsZUZvcm1TdWJtaXRDb25maXJtKHsgY2FyZCwgY2FyZElkIH0pIHtcclxuICAgIGNvbnNvbGUubG9nKCd4Jyk7XHJcbiAgICAvLyBjb25zdCB0ZXh0ID0gJ9CU0LAuLi4nXHJcbiAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgY2FyZC5kZWxldGVCdXR0b25DYXJkKClcclxuICAgICAgICAgICAgcG9wdXBEZWxldGUuc2V0QnV0dG9uVGV4dCjQtSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoYNCe0YjQuNCx0LrQsCDQv9GA0Lgg0YPQtNCw0LvQtdC90LjQuCDQutCw0YDRgtC+0YfQutC4ICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHBvcHVwRGVsZXRlLnNldEJ1dHRvblRleHQoKSlcclxuXHJcbn1cclxucG9wdXBEZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0YDQtdCw0LvQuNC30LDRhtC40Y8g0LrQu9Cw0YHRgdCwIFNlY3Rpb24vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgICBjb25zdCBjYXJkcyA9IG5ldyBDYXJkKGl0ZW0sIHBvcHVwT3BlbkltYWdlU2VjdGlvblxyXG4gICAgICAgIC5vcGVuLCAnLmVsZW1lbnRzLXRlbXBsYXRlJyxcclxuICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkID0gY2FyZHMuZ2V0SWQoKVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhpZCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd4Jyk7XHJcbiAgICAgICAgICAgIHBvcHVwRGVsZXRlLm9wZW4oKSxcclxuICAgICAgICAgICAgICAgIHBvcHVwRGVsZXRlLnNldFN1Ym1pdEhhbmxkZXIoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGlkKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHMuZGVsZXRlQnV0dG9uQ2FyZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwRGVsZXRlLmNsb3NlKClcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgfSxcclxuICAgICAgICAobGlrZUVsZW1lbnQsIGNhcmRJZCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAobGlrZUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmUnKSkge1xyXG4gICAgICAgICAgICAgICAgYXBpLmRlbGV0ZUxpa2UoY2FyZElkKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzLnRvZ2dsZUxpa2UocmVzLmxpa2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvciA9PiBjb25zb2xlLmVycm9yKGDQntGI0LjQsdC60LAg0L/RgNC4INGD0LTQsNC70LXQvdC40Lgg0LvQsNC50LrQsCAke2Vycm9yfWApKSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwaS5hZGRMaWtlKGNhcmRJZClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkcy50b2dnbGVMaWtlKHJlcy5saWtlcylcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IgPT4gY29uc29sZS5lcnJvcihg0J7RiNC40LHQutCwINC/0YDQuCDQv9C+0YHRgtCw0LLQuiDQu9Cw0LnQutCwICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRzLmdlbmVyYXRlQ2FyZCgpXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxucG9wdXBEZWxldGUuc2V0U3VibWl0SGFubGRlcigpXHJcbmNvbnN0IGNhcmRMaXN0U2VsZWN0b3IgPSAnLmVsZW1lbnRzX19saXN0LXRlbXBsYXRlJztcclxuY29uc3QgY2FyZHNMaXN0U2VjdGlvbiA9IG5ldyBTZWN0aW9uKChpdGVtKSA9PiB7XHJcbiAgICBjYXJkc0xpc3RTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChpdGVtKSk7XHJcbn0sXHJcbiAgICBjYXJkTGlzdFNlbGVjdG9yXHJcbik7XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL9CS0JDQm9CY0JTQkNCm0JjQry8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5jb25zdCBmb3JtRWRpdFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGZvcm1FbGVtZW50RWRpdClcclxuY29uc3QgZm9ybUFkZFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGZvcm1FbGVtZW50QWRkKVxyXG5jb25zdCBmb3JtQXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybUVsZW1lbnRBdmF0YXIpXHJcblxyXG4vLyAgLy9cItCS0LrQu9GO0YfQsNC10LxcIiDQv9C+0LTQv9C40YHQutC4INC90LAg0LjQt9C80LXQvdC10L3QuNGPINCyINC40L3Qv9GD0YLQsNGFXHJcbmZvcm1FZGl0VmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKVxyXG5mb3JtQWRkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKVxyXG5mb3JtQXZhdGFyVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKVxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0J7RgdC90L7QstCwIEFQSS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbmZvKCksIGFwaS5nZXRDYXJkKCldKVxyXG4gICAgLnRoZW4oKFtkYXRhVXNlciwgZGF0YUNhcmRdKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YUNhcmQpO1xyXG4gICAgICAgIHVzZXJJZCA9IGRhdGFVc2VyLl9pZFxyXG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXJJZCk7XHJcbiAgICAgICAgZGF0YUNhcmQuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgZWxlbWVudC5teWlkID0gdXNlcklkXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YVVzZXIpO1xyXG4gICAgICAgIHVzZXJJbmZvLnNlclVzZXJJbmZvKHsgYXZhdGFyOiBkYXRhVXNlci5hdmF0YXIsIGZpcnN0bmFtZTogZGF0YVVzZXIubmFtZSwgZGVzY3JpcHRpb246IGRhdGFVc2VyLmFib3V0IH0pXHJcbiAgICAgICAgY2FyZHNMaXN0U2VjdGlvbi5yZW5kZXJJdGVtcyhkYXRhQ2FyZC5yZXZlcnNlKCkpXHJcblxyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoYNCe0YjQuNCx0LrQsCDQv9GA0Lgg0L3QsNGH0LDQu9GM0L3Ri9GFINC00LDQvdC90YvQuSDRgdGC0YDQsNC90LjRhtGLICR7ZXJyb3J9YCkpXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcblxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX3VybCA9IG9wdGlvbnMuYmFzZVVybFxyXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVyc1xyXG4gICAgdGhpcy5fYXV0aG9yaXphdGlvbiA9IG9wdGlvbnMuaGVhZGVycy5hdXRob3JpemF0aW9uXHJcbiAgfVxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0KfRgtC+LdGC0L4g0L/QvtGI0LvQviDQvdC1INGC0LDQujogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIGdldENhcmQoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH1cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5maXJzdG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH1cclxuICBzZXRVc2VyQXZhdGFyKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhcixcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH1cclxuICBhZGRDYXJkKGRhdGEpe1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS50aXRsZSxcclxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9XHJcbiAgYWRkTGlrZShjYXJkSWQpe1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH1cclxuICBkZWxldGVMaWtlKGNhcmRJZCl7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKXtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuXHJcbiAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fdGV4dCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3RleHRcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuID0gKG5hbWUsIGxpbmspID0+IHtcclxuICAgIHRoaXMuX3RleHQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZVxyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHN1cGVyLm9wZW4oKVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICAgICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLm5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9maWxlVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmpvYlNlbGVjdG9yKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hdmF0YXJTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBmaXJzdG5hbWU6ICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9wcm9maWxlVGV4dC50ZXh0Q29udGVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBzZXJVc2VySW5mbyh7YXZhdGFyLCBmaXJzdG5hbWUsIGRlc2NyaXB0aW9ufSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXJcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZmlyc3RuYW1lXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9maWxlVGV4dC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgfVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBmb3JtU3VibWl0KSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5mb3JtU3VibWl0ID0gZm9ybVN1Ym1pdDtcclxuICAgICAgICB0aGlzLnBvcHVwQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlZC1idXR0b24nKTtcclxuICAgICAgICB0aGlzLnBvcHVwQnV0dG9uTG9hZGluZyA9IHRoaXMucG9wdXBCdXR0b24udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgfVxyXG4gICAgX3N1Ym1pdCA9IChldnQpID0+IHtcclxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgdGhpcy5wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IGAke3RoaXMucG9wdXBCdXR0b24udGV4dENvbnRlbnR9Li4uYDtcclxuICAgICAgICB0aGlzLmZvcm1TdWJtaXQoKHsgY2FyZDogdGhpcy5fZWxlbWVudCwgY2FyZElEOiB0aGlzLl9jYXJkSUQgfSkpO1xyXG4gICAgICAgIFxyXG4gICAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgIHRoaXMucG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9zdWJtaXQpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHNldFN1Ym1pdEhhbmxkZXIgKG5ld0Zvcm1TdWJtaXQgKXtcclxuICAgICAgICB0aGlzLmZvcm1TdWJtaXQgPSBuZXdGb3JtU3VibWl0XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHNldEJ1dHRvblRleHQoICkge1xyXG4gICAgICAgIHRoaXMucG9wdXBCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLnBvcHVwQnV0dG9uTG9hZGluZ1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4gPSAoY2FyZCwgY2FyZElkICkgPT4ge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKVxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBjYXJkO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJRCA9IGNhcmRJZDtcclxuICAgIH1cclxufSIsIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7IFxyXG4gICAgfVxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KVxyXG4gICAgfVxyXG4gICAgcmVuZGVySXRlbXMoZGF0YSkge1xyXG4gICAgLy9yZW5kZXJlcigpIHtcclxuICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIoaXRlbSlcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImhhbmRsZUNhcmRDbGljayIsInRlbXBsYXRlU2VsZWN0b3IiLCJvcGVuQ29uZmlybSIsInB1dExpa2UiLCJ0aGlzIiwiY2FyZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9teWlkIiwibXlpZCIsIl9jYXJkSWQiLCJfaWQiLCJfbGlrZXMiLCJsaWtlcyIsIl9saWtlc0xlbmd0aCIsImxlbmd0aCIsIl9wdXRMaWtlIiwiX293bmVySWQiLCJvd25lciIsIl9vcGVuQ29uZmlybSIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl92aXNpYmxlRGVsZXRlQnV0dG9uIiwiX2RlbGV0ZSIsInN0eWxlIiwidmlzaWJpbGl0eSIsIl9jb3VudExpa2UiLCJmb3JFYWNoIiwiZWxlbWVudCIsIl9jb3VudGVyIiwidGV4dENvbnRlbnQiLCJfYnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwiZ2VuZXJhdGVDYXJkIiwiX2VsZW1lbnQiLCJfaW1hZ2UiLCJfdGV4dCIsImFsdCIsInNyYyIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQ2FyZCIsInRvZ2dsZUxpa2UiLCJ0b2dnbGUiLCJkZWxldGVCdXR0b25DYXJkIiwicmVtb3ZlIiwiZ2V0SWQiLCJvcGVuSW1nIiwiX2hhbmRsZU9wZW5EZWxldGUiLCJjYXJkSUQiLCJfY2FyZElEIiwiYWRkRXZlbnRMaXN0ZW5lciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJfcG9wdXBDbG9zZUJ1dHRvbiIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdEFkZCIsInN1cGVyIiwiX2Zvcm0iLCJfaW5wdXQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY29uc29sZSIsImxvZyIsIl9wb3B1cEJ1dHRvbiIsIl9wb3B1cEJ1dHRvbkxvYWRpbmciLCJyZXNldCIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dHNWYWx1ZXMiLCJkYXRhVXNlciIsIl9vblN1Ym1pdCIsInByZXZlbnREZWZhdWx0Iiwic2V0QnV0dG9uVGV4dCIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJfc3VibWl0QnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsImJ1dHRvbiIsInJlbW92ZUF0dHJpYnV0ZSIsImRpc2FibGVCdXR0b24iLCJzZXRBdHRyaWJ1dGUiLCJfc2hvd0lucHV0RXJyb3IiLCJmb3JtRXJyb3IiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImZvcm1JbnB1dCIsInNvbWUiLCJpdGVtIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJjaGVja1ZhbGlkaXR5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dEVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwicG9wdXBFZGl0RWxlbWVudCIsInBvcHVwQWRkRWxlbWVudCIsInBvcHVwQXZhdGFyRWxlbWVudCIsInByb2ZpbGVCdXR0b25FbGVtZW50IiwicHJvZmlsZUVkaXRCdXR0b25FbGVtZW50IiwicHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnQiLCJhdmF0YXJCdXR0b24iLCJmb3JtRWxlbWVudEVkaXQiLCJmb3JtRWxlbWVudEFkZCIsImZvcm1FbGVtZW50QXZhdGFyIiwiYXBpIiwib3B0aW9ucyIsIl91cmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2F1dGhvcml6YXRpb24iLCJhdXRob3JpemF0aW9uIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5mbyIsImZldGNoIiwidGhlbiIsImdldENhcmQiLCJzZXRVc2VySW5mbyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZmlyc3RuYW1lIiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhZGRDYXJkIiwidGl0bGUiLCJhZGRMaWtlIiwiY2FyZElkIiwiZGVsZXRlTGlrZSIsImRlbGV0ZUNhcmQiLCJ1c2VySWQiLCJwb3B1cE9wZW5JbWFnZVNlY3Rpb24iLCJ1c2VySW5mbyIsIl9wcm9maWxlTmFtZSIsIm5hbWVTZWxlY3RvciIsIl9wcm9maWxlVGV4dCIsImpvYlNlbGVjdG9yIiwiX3Byb2ZpbGVBdmF0YXIiLCJhdmF0YXJTZWxlY3RvciIsImdldFVzZXJJbmZvIiwic2VyVXNlckluZm8iLCJlZGl0UG9wdXBXaXRoRm9ybSIsInVzZXJJbmZvQWxsIiwiY2F0Y2giLCJlcnJvciIsImZpbmFsbHkiLCJhZGR0UG9wdXBXaXRoRm9ybSIsImZvcm1BZGRWYWxpZGF0b3IiLCJhbGwiLCJkYXRhQ2FyZCIsImNhcmRzTGlzdFNlY3Rpb24iLCJhZGRJdGVtIiwiY3JlYXRlQ2FyZCIsImF2YXRhclBvcHVwIiwiZm9ybUF2YXRhclZhbGlkYXRvciIsInBvcHVwRGVsZXRlIiwiZm9ybVN1Ym1pdCIsInBvcHVwQnV0dG9uIiwicG9wdXBCdXR0b25Mb2FkaW5nIiwiX3N1Ym1pdCIsInNldFN1Ym1pdEhhbmxkZXIiLCJuZXdGb3JtU3VibWl0Iiwi0LUiLCJjYXJkcyIsImxpa2VFbGVtZW50IiwiY29udGFpbnMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX2NvbnRhaW5lciIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsImZvcm1FZGl0VmFsaWRhdG9yIiwicmV2ZXJzZSJdLCJzb3VyY2VSb290IjoiIn0=