(()=>{"use strict";class t{constructor(t,e,s,o,i){this.card=t,this._name=t.name,this._link=t.link,this._myid=t.myid,this._cardId=t._id,this._likes=t.likes,this._likesLength=t.likes.length,this._putLike=i,this._ownerId=t.owner._id,this._openConfirm=o,this._templateSelector=s,this.handleCardClick=e}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_visibleDeleteButton(){this._myid===this._ownerId?this._delete.style.visibility="visible":this._myid!==this._ownerId&&(this._delete.style.visibility="hidden")}_countLike(){this._likes.forEach((t=>{t._id!==this._myid?this._counter.textContent=this._likesLength:this._button.classList.add("element__like-button_active")}))}generateCard(){return this._element=this._getTemplate(),this._counter=this._element.querySelector(".element__like-count"),this._delete=this._element.querySelector(".element__delete"),this._button=this._element.querySelector(".element__like-button"),this._image=this._element.querySelector(".element__image"),this._text=this._element.querySelector(".element__title"),this._text.textContent=this._name,this._image.alt=this._name,this._image.src=this._link,this._countLike(),this._visibleDeleteButton(),this._setEventListeners(),this._element}_likeCard(){this._putLike(this._button,this._cardId)}toggleLike(t){this._button.classList.toggle("element__like-button_active"),this._counter.textContent=t.length}deleteButtonCard(){this._element.remove(),this._element=null}getId(){return this._cardId}openImg(){this.handleCardClick(this._name,this._link)}_handleOpenDelete(){this._openConfirm({card:this,cardID:this._cardID})}_setEventListeners(){this._button.addEventListener("click",(()=>{this._likeCard()})),this._image.addEventListener("click",(()=>{this.openImg()})),this._delete.addEventListener("click",(()=>{this._handleOpenDelete()}))}}class e{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._popupCloseButton=this._popup.querySelector(".popup__close")}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(t=>{t.target===t.currentTarget&&this.close()})),this._popupCloseButton.addEventListener("click",(()=>{this.close()}))}}class s extends e{constructor(t,e){super(t),this.formSubmitAdd=e,this._form=this._popup.querySelector(".form"),this._input=this._popup.querySelectorAll(".form__item"),console.log(this._input),this._popupButton=this._popup.querySelector(".popup__saved-button"),this._popupButtonLoading=this._popupButton.textContent}close(){super.close(),this._form.reset()}_getInputValues(){return this.values={},this._input.forEach((t=>{this.values[t.name]=t.value})),this.values}setInputsValues(t){this._input.forEach((e=>{e.value=t[e.name]}))}_onSubmit=t=>{t.preventDefault(),this._popupButton.textContent=`${this._popupButton.textContent}...`,this.formSubmitAdd(this._getInputValues())};setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this._onSubmit)}setButtonText(){this._popupButton.textContent=this._popupButtonLoading}}const o={formSelector:".form",inputSelector:".form__item",submitButtonSelector:".popup__saved-button",inactiveButtonClass:"popup__saved-button_disabled",inputErrorClass:"form__item-error",errorClass:"error_opened"};class i{constructor(t,e){this.formSelector=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=Array.from(this.formSelector.querySelectorAll(this._inputSelector)),this._submitButton=this.formSelector.querySelector(this._submitButtonSelector)}_enableButton(t){t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled")}disableButton(t){t.classList.add(this._inactiveButtonClass),t.setAttribute("disabled",!0)}_showInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}_hideInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}_hasInvalidInput(t){return t.some((t=>!t.validity.valid))}_checkInputValidity(t){t.checkValidity()?this._hideInputError(t):this._showInputError(t)}setEventListeners(){this.disableButton(this._submitButton),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this.toggleButtonState(),this._checkInputValidity(t)}))}))}toggleButtonState(){this._hasInvalidInput(this._inputList)?this.disableButton(this._submitButton):this._enableButton(this._submitButton)}resetValidation(){this.toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}enableValidation(){this.setEventListeners()}}const n=document.querySelector(".popup_type_edit"),r=document.querySelector(".popup_type_add"),a=(document.querySelector(".popup_type_image"),document.querySelector(".popup_type_confirm"),document.querySelector(".popup_type_avatar")),l=document.querySelector(".profile"),u=l.querySelector(".profile__edit-button"),h=l.querySelector(".profile__add-button"),c=document.querySelector(".profile__avatar-button"),_=n.querySelector(".form"),p=r.querySelector(".form"),d=a.querySelector(".form"),m=new class{constructor(t){this._url=t.baseUrl,this._headers=t.headers,this._authorization=t.headers.authorization}_checkResponse(t){return t.ok?t.json():Promise.reject(`Что-то пошло не так: ${t.status}`)}getInfo(){return fetch(`${this._url}/users/me`,{headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._checkResponse)}getCard(){return fetch(`${this._url}/cards`,{headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._checkResponse)}setUserInfo(t){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t.firstname,about:t.description})}).then(this._checkResponse)}setUserAvatar(t){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t.avatar})}).then(this._checkResponse)}addCard(t){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t.title,link:t.link})}).then(this._checkResponse)}addLike(t){return fetch(`${this._url}/cards/${t}/likes`,{method:"PUT",headers:{authorization:this._authorization}}).then(this._checkResponse)}deleteLike(t){return fetch(`${this._url}/cards/${t}/likes`,{method:"DELETE",headers:{authorization:this._authorization}}).then(this._checkResponse)}deleteCard(t){return fetch(`${this._url}/cards/${t}`,{method:"DELETE",headers:{authorization:this._authorization}}).then(this._checkResponse)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-66",headers:{authorization:"26786be3-fed9-4d83-9ae2-1348eee1b7d5","Content-Type":"application/json"}});let f;const v=new class extends e{constructor(t){super(t),this._image=this._popup.querySelector(".popup__image"),this._text=this._popup.querySelector(".popup__text")}open=(t,e)=>{this._text.textContent=t,this._image.alt=t,this._image.src=e,super.open()}}(".popup_type_image");v.setEventListeners();const y=new class{constructor(t){this._profileName=document.querySelector(t.nameSelector),this._profileText=document.querySelector(t.jobSelector),this._profileAvatar=document.querySelector(t.avatarSelector)}getUserInfo(){return{firstname:this._profileName.textContent,description:this._profileText.textContent}}serUserInfo({avatar:t,firstname:e,description:s}){this._profileAvatar.src=t,this._profileName.textContent=e,this._profileText.textContent=s}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__avatar"}),g=new s(".popup_type_edit",(function(t){m.setUserInfo(t).then((t=>{const e={avatar:t.avatar,firstname:t.name,description:t.about};y.serUserInfo(e),g.close()})).catch((t=>console.error(`Ошибка при редактировании ${t}`))).finally((()=>g.setButtonText()))}));g.setEventListeners(),u.addEventListener("click",(function(){g.setInputsValues(y.getUserInfo()),console.log(y.getUserInfo()),g.open()}));const S=new s(".popup_type_add",(function(t){console.log("open"),p.reset(),B.resetValidation(),Promise.all([m.getInfo(),m.addCard(t)]).then((([t,e])=>{console.log(e),f=t._id,e.myid=f,k.addItem(L(e)),S.close()})).catch((t=>console.error(`Ошибка при создании карточки ${t}`))).finally((()=>S.setButtonText()))}));S.setEventListeners(),h.addEventListener("click",(function(){S.open(),B.resetValidation()}));const b=new s(".popup_type_avatar",(function(t){m.setUserAvatar(t).then((t=>{console.log(t),y.serUserInfo({avatar:t.avatar,firstname:t.name,description:t.about}),b.close()})).catch((t=>console.error(`Ошибка при редактировании аватара ${t}`))).finally((()=>b.setEventListeners()))}));b.setEventListeners(),console.log(c),c.addEventListener("click",(function(){d.reset(),I.resetValidation(),b.open()}));const C=new class extends e{constructor(t,e){super(t),this.formSubmit=e,this.popupButton=this._popup.querySelector(".popup__saved-button"),this.popupButtonLoading=this.popupButton.textContent}_submit=t=>{t.preventDefault(),this.popupButton.textContent="Да...",this.formSubmit({card:this._element,cardID:this._cardID})};setEventListeners(){super.setEventListeners(),this.popupButton.addEventListener("click",this._submit)}setSubmitHanlder(t){this.formSubmit=t}setButtonText(){this.popupButton.textContent=this.popupButtonLoading}open=(t,e)=>{super.open(),this._element=t,this._cardID=e}}(".popup_type_confirm",(function({card:t,cardId:e}){console.log("x"),C.getButtonText(),m.deleteCard(e).then((e=>{console.log(e),t.deleteButtonCard(),C.getButtonText(),C.close()})).catch((t=>console.error(`Ошибка при удалении карточки ${t}`)))}));function L(e){const s=new t(e,v.open,".elements-template",(()=>{const t=s.getId();console.log(t),console.log("x"),C.open(),C.setSubmitHanlder((()=>{m.deleteCard(t).then((()=>{s.deleteButtonCard(),C.close()})).catch((t=>console.error(`Ошибка при удалении картинки ${t}`))).finally((()=>C.setButtonText()))}))}),((t,e)=>{t.classList.contains("element__like-button_active")?m.deleteLike(e).then((t=>{console.log(t),s.toggleLike(t.likes)})).catch((t=>console.error(`Ошибка при удалении лайка ${t}`))):m.addLike(e).then((t=>{console.log(t),s.toggleLike(t.likes)})).catch((t=>console.error(`Ошибка при поставк лайка ${t}`)))}));return s.generateCard()}C.setEventListeners(),C.setSubmitHanlder();const k=new class{constructor(t,e){this.renderer=t,this._container=document.querySelector(e)}addItem(t){this._container.prepend(t)}renderItems(t){t.forEach((t=>{this.renderer(t)}))}}((t=>{k.addItem(L(t))}),".elements__list-template"),E=new i(o,_),B=new i(o,p),I=new i(o,d);E.enableValidation(),B.enableValidation(),I.enableValidation(),Promise.all([m.getInfo(),m.getCard()]).then((([t,e])=>{console.log(e),f=t._id,console.log(f),e.forEach((t=>{t.myid=f})),console.log(t),y.serUserInfo({avatar:t.avatar,firstname:t.name,description:t.about}),k.renderItems(e.reverse())})).catch((t=>console.error(`Ошибка при начальных данный страницы ${t}`)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZHZILFFBQVFDLElBQUlzSCxHQUNabkIsRUFBUzFGLEVBQVMzRSxJQUNsQmlFLFFBQVFDLElBQUltRyxHQUNabUIsRUFBU3BLLFNBQVFDLElBQ2JBLEVBQVF2QixLQUFPdUssQ0FBTSxJQUV6QnBHLFFBQVFDLElBQUlTLEdBQ1o0RixFQUFTUSxZQUFZLENBQUVqQixPQUFRbkYsRUFBU21GLE9BQVFKLFVBQVcvRSxFQUFTakYsS0FBTWtLLFlBQWFqRixFQUFTZ0YsUUFDaEc4QixFQUFpQm9CLFlBQVlyQixFQUFTdUIsVUFBVSxJQUduRDdCLE9BQU9DLEdBQVVsSCxRQUFRa0gsTUFBTyx3Q0FBdUNBLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCB0ZW1wbGF0ZVNlbGVjdG9yLCBvcGVuQ29uZmlybSwgcHV0TGlrZSkge1xyXG4gICAgICAgIHRoaXMuY2FyZCA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgICAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgICAgIHRoaXMuX215aWQgPSBkYXRhLm15aWQ7XHJcbiAgICAgICAgdGhpcy5fY2FyZElkID0gZGF0YS5faWRcclxuICAgICAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICAgICAgdGhpcy5fbGlrZXNMZW5ndGggPSBkYXRhLmxpa2VzLmxlbmd0aDtcclxuICAgICAgICB0aGlzLl9wdXRMaWtlID0gcHV0TGlrZTtcclxuICAgICAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICAgICAgdGhpcy5fb3BlbkNvbmZpcm0gPSBvcGVuQ29uZmlybVxyXG4gICAgICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG5cclxuICAgIH1cclxuICAgIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgICAgICAvLyDQt9Cw0LHQuNGA0LDQtdC8INGA0LDQt9C80LXRgtC60YMg0LjQtyBIVE1MINC4INC60LvQvtC90LjRgNGD0LXQvCDRjdC70LXQvNC10L3RglxyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcclxuICAgICAgICAgICAgLmNvbnRlbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50JylcclxuICAgICAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcbiAgICBfdmlzaWJsZURlbGV0ZUJ1dHRvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fbXlpZCA9PT0gdGhpcy5fb3duZXJJZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9kZWxldGUuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJ1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fbXlpZCAhPT0gdGhpcy5fb3duZXJJZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9kZWxldGUuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX2NvdW50TGlrZSgpIHtcclxuICAgICAgICB0aGlzLl9saWtlcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5faWQgPT09IHRoaXMuX215aWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QuYWRkKCdlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmUnKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fY291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzTGVuZ3RoXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX2NvdW50ZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlLWNvdW50JylcclxuICAgICAgICB0aGlzLl9kZWxldGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19kZWxldGUnKVxyXG4gICAgICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2xpa2UtYnV0dG9uJylcclxuICAgICAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ltYWdlJylcclxuICAgICAgICB0aGlzLl90ZXh0ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fdGl0bGUnKVxyXG4gICAgICAgIHRoaXMuX3RleHQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgdGhpcy5faW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICB0aGlzLl9jb3VudExpa2UoKVxyXG4gICAgICAgIHRoaXMuX3Zpc2libGVEZWxldGVCdXR0b24oKVxyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKClcclxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQpNGD0L3QutGG0LjRjyDQu9Cw0LnQutCwXHJcbiAgICBfbGlrZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fcHV0TGlrZSh0aGlzLl9idXR0b24sIHRoaXMuX2NhcmRJZClcclxuICAgICAgICAvLyB0aGlzLl9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlJylcclxuICAgIH07XHJcbiAgICB0b2dnbGVMaWtlKGxpa2VzKSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2VsZW1lbnRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpXHJcbiAgICAgICAgdGhpcy5fY291bnRlci50ZXh0Q29udGVudCA9IGxpa2VzLmxlbmd0aFxyXG4gICAgfVxyXG4gICAgLy/QpNGD0L3QutGG0LjRjyDRg9C00LDQu9C10L3QuNGPXHJcbiAgICBkZWxldGVCdXR0b25DYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGxcclxuXHJcbiAgICB9XHJcbiAgICBnZXRJZCgpIHtcclxuICAgIHJldHVybiAgdGhpcy5fY2FyZElkIFxyXG4gICAgfVxyXG4gICAgb3BlbkltZygpIHtcclxuICAgICAgICB0aGlzLmhhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKVxyXG4gICAgfVxyXG4gICAgX2hhbmRsZU9wZW5EZWxldGUoKSB7XHJcbiAgICAgICAgdGhpcy5fb3BlbkNvbmZpcm0oeyBjYXJkOiB0aGlzLCBjYXJkSUQ6IHRoaXMuX2NhcmRJRCB9KVxyXG5cclxuICAgIH1cclxuICAgIC8v0YHQu9GD0YjQsNGC0LXQu9C4XHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgLy/RgdC70YPRiNCw0YLQtdC70Ywg0LvQsNC50LrQsFxyXG4gICAgICAgIHRoaXMuX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fbGlrZUNhcmQoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy/RgdC70YPRiNCw0YLQtdC70Ywg0YPQtNCw0LvRj9C70LrQuFxyXG4gICAgICAgIC8vIHRoaXMuX2RlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAvLyAgICAgdGhpcy5fZGVsZXRlQnV0dG9uQ2FyZCgpXHJcbiAgICAgICAgLy8gfSlcclxuICAgICAgICAvL9GB0LvRg9GI0LDRgtC10LvRjCDQvtGC0LrRgNGL0YLQuNGPINC60LDRgNGC0LjQvdC60LhcclxuICAgICAgICB0aGlzLl9pbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5vcGVuSW1nKClcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyAvL9GB0LvRg9GI0LDRgtC10LvRjCBcclxuICAgICAgICB0aGlzLl9kZWxldGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZU9wZW5EZWxldGUoKVxyXG5cclxuICAgICAgICB9KVxyXG5cclxuICAgIH1cclxufVxyXG5cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIC8vdGhpcy5fcG9wdXAgPSBwb3B1cFNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2xvc2UnKTtcclxuICAgIH1cclxuXHJcbiAgICAvL9Ce0YLQutGA0YvRgtC40LUg0L/QvtC/0LDQvy8vXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIilcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSlcclxuXHJcbiAgICB9XHJcbiAgICAvL9CX0LDQutGA0YvRgtC40LUg0L/QvtC/0LDQvy8vXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpXHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpXHJcbiAgICB9XHJcbiAgICAvL9CX0LDQutGA0YvRgtC40LUg0L/QvtC/0LDQvyBFc2MvL1xyXG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8v0KHQu9GD0YjQsNGC0LXQu9GMINC30LDQutGA0YvRgtC40Y8sINC90LDQttC40LzQsNGPINC90LAg0YLQtdC80L0u0Y3QutGA0LDQvSDQuCDQt9Cw0LrRgNGL0YLQuNC1INC90LAg0LrQvdC+0L/QutGDINC60YDQtdGB0YLQuNC6Ly9cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBmb3JtU3VibWl0QWRkKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5mb3JtU3VibWl0QWRkID0gZm9ybVN1Ym1pdEFkZDtcclxuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLmZvcm0nKTtcclxuICAgICAgICB0aGlzLl9pbnB1dCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtX19pdGVtJyk7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5faW5wdXQpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlZC1idXR0b24nKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEJ1dHRvbkxvYWRpbmcgPSB0aGlzLl9wb3B1cEJ1dHRvbi50ZXh0Q29udGVudDtcclxuXHJcbiAgICB9XHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpXHJcbiAgICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgfVxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIHRoaXMudmFsdWVzID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXQuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlcztcclxuICAgIH1cclxuICAgIHNldElucHV0c1ZhbHVlcyhkYXRhVXNlcikge1xyXG4gICAgICAgIHRoaXMuX2lucHV0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gZGF0YVVzZXJbaW5wdXQubmFtZV07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uU3VibWl0ID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50ID0gYCR7dGhpcy5fcG9wdXBCdXR0b24udGV4dENvbnRlbnR9Li4uYDtcclxuICAgICAgICB0aGlzLmZvcm1TdWJtaXRBZGQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX29uU3VibWl0KVxyXG4gICAgfVxyXG5cclxuICAgIHNldEJ1dHRvblRleHQoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBCdXR0b24udGV4dENvbnRlbnQgPSAgdGhpcy5fcG9wdXBCdXR0b25Mb2FkaW5nXHJcbiAgIFxyXG4gICAgfVxyXG5cclxuXHJcbn1cclxuXHJcblxyXG5cclxuXHJcbiIsImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0gKHtcclxuICAgIGZvcm1TZWxlY3RvcjogJy5mb3JtJyxcclxuICAgIGlucHV0U2VsZWN0b3I6ICcuZm9ybV9faXRlbScsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fc2F2ZWQtYnV0dG9uJyxcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fc2F2ZWQtYnV0dG9uX2Rpc2FibGVkJyxcclxuICAgIGlucHV0RXJyb3JDbGFzczogJ2Zvcm1fX2l0ZW0tZXJyb3InLFxyXG4gICAgZXJyb3JDbGFzczogJ2Vycm9yX29wZW5lZCdcclxufSk7XHJcblxyXG5leHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm0pIHtcclxuICAgICAgICB0aGlzLmZvcm1TZWxlY3RvciA9IGZvcm0sXHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcixcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IsXHJcbiAgICAgICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyxcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcyxcclxuICAgICAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzLFxyXG5cclxuICAgICAgICAgICAgLy90aGlzLl9mb3JtID0gQXJyYXkuZnJvbSh0aGlzLmZvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKVxyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuX2Zvcm0pXHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5mb3JtU2VsZWN0b3IucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSlcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLmZvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKVxyXG4gICAgfVxyXG5cclxuICAgIC8vINC60L3QvtC/0LrQsCDQsNC60YLQuNCyXHJcbiAgICBfZW5hYmxlQnV0dG9uKGJ1dHRvbikge1xyXG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpXHJcbiAgICAgICAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpXHJcbiAgICB9XHJcbiAgICAvLyDQutC90L7Qv9C60LAg0L3QtdCw0LrRgtC40LJcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uKSB7XHJcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcylcclxuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDQpNGD0L3QutGG0LjRjyAg0L/QvtC70Y8gYyDQvtGI0LjQsdC60L7QuVxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0KSB7XHJcbiAgICAgICAgY29uc3QgZm9ybUVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGZvcm1FcnJvci50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlXHJcbiAgICAgICAgZm9ybUVycm9yLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vICAvLyDQpNGD0L3QutGG0LjRjyAg0L/QvtC70Y8g0LHQtdC3INC+0YjQuNCx0LrQuFxyXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0KSB7XHJcbiAgICAgICAgY29uc3QgZm9ybUVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGZvcm1FcnJvci50ZXh0Q29udGVudCA9IFwiXCJcclxuICAgICAgICBmb3JtRXJyb3IuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH07XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dChmb3JtSW5wdXQpIHtcclxuICAgICAgICByZXR1cm4gZm9ybUlucHV0LnNvbWUoaXRlbSA9PiAhaXRlbS52YWxpZGl0eS52YWxpZClcclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XHJcbiAgICAgICAgaWYgKGlucHV0LmNoZWNrVmFsaWRpdHkoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dClcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyAvL9GE0YPQvdC60YbQuNGPINGB0LvRg9GI0LDRgtC10LvQtdC5XHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAgICB0aGlzLmRpc2FibGVCdXR0b24odGhpcy5fc3VibWl0QnV0dG9uKVxyXG4gICAgICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KVxyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbilcclxuICAgICAgICAgICAgLy8gICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vICAgICB0aGlzLl9lbmFibGVCdXR0b24odGhpcy5fc3VibWl0QnV0dG9uKVxyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfTtcclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKCl7XHJcbiAgICBcclxuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbilcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAodGhpcy5fZW5hYmxlQnV0dG9uKCh0aGlzLl9zdWJtaXRCdXR0b24pKSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IFxyXG4gIFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcclxuICAgICAgICB9KTtcclxuICBcclxuICAgICAgfVxyXG4gICAgLy8gICAvL9GE0YPQvdC60YbQuNGPINC30LDQv9GD0YHQutCwINCy0YvQu9C40LTQsNGG0LjQuFxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKClcclxuICAgIH1cclxufVxyXG5cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9Ch0LDRhdCw0LvQuNC9JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9saXZlLnN0YXRpY2ZsaWNrci5jb20vNjU1MzUvNTE2NjQzMTM3MDVfNTcxMzc5MTI1N19rLmpwZydcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfQlNCw0LPQtdGB0YLQsNC9JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9saXZlLnN0YXRpY2ZsaWNrci5jb20vMTk1OC80NDM2ODk3ODMwNF8yNzMyYjU4MzI1X2suanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9CY0LLQsNC90L7QstC+JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2l2YW5vdm8uanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9Ca0LDQvNGH0LDRgtC60LAnLFxyXG4gICAgICAgIGxpbms6ICdodHRwczovL2xpdmUuc3RhdGljZmxpY2tyLmNvbS82NTUzNS80ODgyMDEwMDUzMl84N2ExY2ViMTBkX2suanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9Cl0L7Qu9C80L7Qs9C+0YDRgdC60LjQuSDRgNCw0LnQvtC9JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2tob2xtb2dvcnNreS1yYXlvbi5qcGcnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIHRpdGxlOiAn0JHQsNC50LrQsNC7JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9saXZlLnN0YXRpY2ZsaWNrci5jb20vNjU1MzUvNTE0MjEyMDU0MzRfODkxM2Y0YTFhNV9rLmpwZydcclxuICAgIH1cclxuXTtcclxuXHJcbi8vINCd0LDRhdC+0LTQuNC8IHBvcHVwXHJcbmNvbnN0IHBvcHVwRWRpdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdFwiKTtcclxuY29uc3QgcG9wdXBFZGl0RWxlbWVudFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9lZGl0XCJcclxuY29uc3QgcG9wdXBBZGRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2FkZFwiKTtcclxuY29uc3QgcG9wdXBBZGRFbGVtZW50U2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2FkZFwiXHJcblxyXG5jb25zdCBwb3B1cE9wZW5JbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfaW1hZ2VcIik7XHJcbmNvbnN0IHBvcHVwT3BlbkltYWdlRWxlbWVudFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9pbWFnZVwiXHJcbmNvbnN0IHBvcHVwQ2xvc2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfY29uZmlybScpXHJcbmNvbnN0IHBvcHVwQ29uZmlybUVsZW1lbnRTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfY29uZmlybVwiXHJcbmNvbnN0IHBvcHVwQXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2F2YXRhcicpXHJcbmNvbnN0IHBvcHVwQXZhdGFyRWxlbWVudFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9hdmF0YXJcIlxyXG5cclxuLy8g0J3QsNGF0L7QtNC40Lwg0LrQvdC+0L/QutC4XHJcbmNvbnN0IHByb2ZpbGVCdXR0b25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQgPSBwcm9maWxlQnV0dG9uRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQnV0dG9uRWxlbWVudCA9IHByb2ZpbGVCdXR0b25FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1idXR0b24nKVxyXG5cclxuXHJcblxyXG4vLyDQndCw0YXQvtC00LjQvCDQv9C+0LvRjyDRhNC+0YDQvNGLINCyIERPTVxyXG5jb25zdCBmb3JtRWxlbWVudEVkaXQgPSBwb3B1cEVkaXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuY29uc3QgZm9ybUVsZW1lbnRBZGQgPSBwb3B1cEFkZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG5jb25zdCBmb3JtRWxlbWVudEF2YXRhciA9IHBvcHVwQXZhdGFyRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcblxyXG5jb25zdCBjb25maWcgPSB7XHJcbiAgICBuYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9fdGl0bGUnLFxyXG4gICAgam9iU2VsZWN0b3I6ICcucHJvZmlsZV9fc3VidGl0bGUnLFxyXG4gICAgYXZhdGFyU2VsZWN0b3I6ICcucHJvZmlsZV9fYXZhdGFyJ1xyXG59XHJcblxyXG5leHBvcnQgeyBwb3B1cEVkaXRFbGVtZW50LCBwb3B1cEVkaXRFbGVtZW50U2VsZWN0b3IsIHBvcHVwQWRkRWxlbWVudCwgcG9wdXBBZGRFbGVtZW50U2VsZWN0b3IsIHBvcHVwT3BlbkltYWdlRWxlbWVudCwgcG9wdXBPcGVuSW1hZ2VFbGVtZW50U2VsZWN0b3IsIHBvcHVwQ2xvc2VFbGVtZW50LCBwb3B1cENvbmZpcm1FbGVtZW50U2VsZWN0b3IsIHBvcHVwQXZhdGFyRWxlbWVudCwgcG9wdXBBdmF0YXJFbGVtZW50U2VsZWN0b3IsIHByb2ZpbGVCdXR0b25FbGVtZW50LCBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQsIHByb2ZpbGVBZGRCdXR0b25FbGVtZW50LCBhdmF0YXJCdXR0b24sIGZvcm1FbGVtZW50RWRpdCwgZm9ybUVsZW1lbnRBZGQsIGZvcm1FbGVtZW50QXZhdGFyLCBjb25maWcgfSIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIlxyXG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnXHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzJ1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnXHJcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJ1xyXG5pbXBvcnQgQXBpIGZyb20gJy4uL2NvbXBvbmVudHMvQXBpLmpzJ1xyXG5pbXBvcnQgUG9wdXBXaXRoRGVsZXRlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzJ1xyXG5cclxuaW1wb3J0IHsgdmFsaWRhdGlvbkNvbmZpZyB9IGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcydcclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcydcclxuaW1wb3J0ICcuL2luZGV4LmNzcydcclxuXHJcbmltcG9ydCB7IHBvcHVwRWRpdEVsZW1lbnQsIHBvcHVwRWRpdEVsZW1lbnRTZWxlY3RvciwgcG9wdXBBZGRFbGVtZW50LCBwb3B1cEFkZEVsZW1lbnRTZWxlY3RvciwgcG9wdXBPcGVuSW1hZ2VFbGVtZW50LCBwb3B1cE9wZW5JbWFnZUVsZW1lbnRTZWxlY3RvciwgcG9wdXBDbG9zZUVsZW1lbnQsIHBvcHVwQ29uZmlybUVsZW1lbnRTZWxlY3RvciwgcG9wdXBBdmF0YXJFbGVtZW50LCBwb3B1cEF2YXRhckVsZW1lbnRTZWxlY3RvciwgcHJvZmlsZUJ1dHRvbkVsZW1lbnQsIHByb2ZpbGVFZGl0QnV0dG9uRWxlbWVudCwgcHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnQsIGF2YXRhckJ1dHRvbiwgZm9ybUVsZW1lbnRFZGl0LCBmb3JtRWxlbWVudEFkZCwgZm9ybUVsZW1lbnRBdmF0YXIsIGNvbmZpZyB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcydcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/Qn9C+0LTQutGO0YcuINC6INGB0LXRgNCy0LXRgNGDLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICAgIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTY2JyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiAnMjY3ODZiZTMtZmVkOS00ZDgzLTlhZTItMTM0OGVlZTFiN2Q1JyxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9XHJcbn0pO1xyXG5cclxubGV0IHVzZXJJZDtcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0J/QvtC/0LDQvyDQvtGC0LrRgNGL0YLQuNGPINC60LDRgNGC0L7Rh9C10LovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5jb25zdCBwb3B1cE9wZW5JbWFnZVNlY3Rpb24gPSBuZXcgUG9wdXBXaXRoSW1hZ2UocG9wdXBPcGVuSW1hZ2VFbGVtZW50U2VsZWN0b3IpXHJcbnBvcHVwT3BlbkltYWdlU2VjdGlvbi5zZXRFdmVudExpc3RlbmVycygpXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy/Qn9C+0L/QsNC/IEVESVRcclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oY29uZmlnKTtcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL9Cf0L7Qv9Cw0L8gRURJVC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgZWRpdFBvcHVwV2l0aEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cEVkaXRFbGVtZW50U2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXRFZGl0KVxyXG5mdW5jdGlvbiBoYW5kbGVGb3JtU3VibWl0RWRpdChkYXRhKSB7XHJcbiAgICBhcGkuc2V0VXNlckluZm8oZGF0YSlcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VySW5mb0FsbCA9IHsgYXZhdGFyOiByZXMuYXZhdGFyLCBmaXJzdG5hbWU6IHJlcy5uYW1lLCBkZXNjcmlwdGlvbjogcmVzLmFib3V0IH1cclxuICAgICAgICAgICAgdXNlckluZm8uc2VyVXNlckluZm8odXNlckluZm9BbGwpXHJcbiAgICAgICAgICAgIGVkaXRQb3B1cFdpdGhGb3JtLmNsb3NlKClcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyb3IgPT4gY29uc29sZS5lcnJvcihg0J7RiNC40LHQutCwINC/0YDQuCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC4ICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IGVkaXRQb3B1cFdpdGhGb3JtLnNldEJ1dHRvblRleHQoKSlcclxuXHJcbn1cclxuZWRpdFBvcHVwV2l0aEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG4vLy/QmNC60L7QvdC60LAgRURJVC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxucHJvZmlsZUVkaXRCdXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xpY2tQcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQpO1xyXG5mdW5jdGlvbiBjbGlja1Byb2ZpbGVFZGl0QnV0dG9uRWxlbWVudCgpIHtcclxuICAgIGVkaXRQb3B1cFdpdGhGb3JtLnNldElucHV0c1ZhbHVlcyh1c2VySW5mby5nZXRVc2VySW5mbygpKVxyXG4gICAgY29uc29sZS5sb2codXNlckluZm8uZ2V0VXNlckluZm8oKSk7XHJcbiAgICBlZGl0UG9wdXBXaXRoRm9ybS5vcGVuKClcclxufVxyXG4vLyBmdW5jdGlvbiBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnRGdW5jdGlvbigpIHtcclxuLy8gICAgIGVkaXRQb3B1cFdpdGhGb3JtLm9wZW4oKVxyXG4vLyAgICAgY29uc3QgcHJvZmlsZURhdGEgID0gdXNlckluZm8uZ2V0VXNlckluZm8oKSAvLyDQktC+0YIg0YLRg9GCINCyINC/0LXRgNC10LzQtdC90L3Rg9GOIHByb2ZpbGVEYXRhINC/0L7Qu9C+0LbQuNC70Lgg0L7QsdGK0LXQutGCLCDRgtC+0YIg0YfRgtC+INGC0Ysg0LrQvtC90YHQvtC70YzQu9C+0LPQuNGA0YPQtdGI0Ywg0L3QsCDRgdC60YDQuNC90YjQvtGC0LUgXHJcbi8vICAgY29uc29sZS5sb2cocHJvZmlsZURhdGEpO1xyXG4vLyAgICAgbmFtZUVkaXRJbnB1dC52YWx1ZSA9IHByb2ZpbGVEYXRhLmZpcnN0bmFtZVxyXG4vLyAgICAgam9iRWRpdElucHV0LnZhbHVlID0gcHJvZmlsZURhdGEuZGVzY3JpcHRpb25cclxuLy8gICB9XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/Qn9C+0L/QsNC/IEFELy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgYWRkdFBvcHVwV2l0aEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cEFkZEVsZW1lbnRTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdEFkZClcclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdEFkZChkYXRhKSB7XHJcbiAgICBjb25zb2xlLmxvZygnb3BlbicpO1xyXG4gICAgZm9ybUVsZW1lbnRBZGQucmVzZXQoKTtcclxuICAgIGZvcm1BZGRWYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKClcclxuICAgIFByb21pc2UuYWxsKFthcGkuZ2V0SW5mbygpLCBhcGkuYWRkQ2FyZChkYXRhKV0pXHJcbiAgICAgICAgLnRoZW4oKFtkYXRhVXNlciwgZGF0YUNhcmRdKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGFDYXJkKTtcclxuICAgICAgICAgICAgdXNlcklkID0gZGF0YVVzZXIuX2lkICBcclxuICAgICAgICAgICAgZGF0YUNhcmQubXlpZCA9IHVzZXJJZFxyXG4gICAgICAgICAgICAvLyBkYXRhQ2FyZC5teWlkID0gZGF0YVVzZXIuX2lkXHJcbiAgICAgICAgICAgIGNhcmRzTGlzdFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGRhdGFDYXJkKSk7XHJcbiAgICAgICAgICAgIGFkZHRQb3B1cFdpdGhGb3JtLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoYNCe0YjQuNCx0LrQsCDQv9GA0Lgg0YHQvtC30LTQsNC90LjQuCDQutCw0YDRgtC+0YfQutC4ICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IGFkZHRQb3B1cFdpdGhGb3JtLnNldEJ1dHRvblRleHQoKSlcclxufTtcclxuYWRkdFBvcHVwV2l0aEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG4vLy/QmNC60L7QvdC60LAgQURELy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5wcm9maWxlQWRkQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrUHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnQpO1xyXG5mdW5jdGlvbiBjbGlja1Byb2ZpbGVBZGRCdXR0b25FbGVtZW50KCkge1xyXG4gICAgYWRkdFBvcHVwV2l0aEZvcm0ub3BlbigpXHJcbiAgICBmb3JtQWRkVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpXHJcbn1cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/Qn9C+0L/QsNC/IEFWQVRBUi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwQXZhdGFyRWxlbWVudFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0QXZhdGFyKVxyXG5mdW5jdGlvbiBoYW5kbGVGb3JtU3VibWl0QXZhdGFyKGRhdGEpIHtcclxuICAgIC8vIGZvcm1FbGVtZW50QXZhdGFyLnJlc2V0KCk7XHJcbiAgICAvLyBmb3JtQXZhdGFyVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpXHJcbiAgICBhcGkuc2V0VXNlckF2YXRhcihkYXRhKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgIHVzZXJJbmZvLnNlclVzZXJJbmZvKHsgYXZhdGFyOiByZXMuYXZhdGFyLCBmaXJzdG5hbWU6IHJlcy5uYW1lLCBkZXNjcmlwdGlvbjogcmVzLmFib3V0IH0pXHJcbiAgICAgICAgICAgYXZhdGFyUG9wdXAuY2xvc2UoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnJvciA9PiBjb25zb2xlLmVycm9yKGDQntGI0LjQsdC60LAg0L/RgNC4INGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Lgg0LDQstCw0YLQsNGA0LAgJHtlcnJvcn1gKSkpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gYXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKSlcclxufTtcclxuYXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG5cclxuY29uc29sZS5sb2coYXZhdGFyQnV0dG9uKTtcclxuLy8v0JjQutC+0L3QutCwIENMT1NFLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja0F2YXRhckJ1dHRvbilcclxuZnVuY3Rpb24gY2xpY2tBdmF0YXJCdXR0b24oKSB7XHJcbiAgICBmb3JtRWxlbWVudEF2YXRhci5yZXNldCgpO1xyXG4gICAgZm9ybUF2YXRhclZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKVxyXG4gICAgYXZhdGFyUG9wdXAub3BlbigpXHJcblxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0J/QvtC/0LDQvyBDT05GSVJNLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5cclxuY29uc3QgcG9wdXBEZWxldGUgPSBuZXcgUG9wdXBXaXRoRGVsZXRlKHBvcHVwQ29uZmlybUVsZW1lbnRTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdENvbmZpcm0pXHJcbmZ1bmN0aW9uIGhhbmRsZUZvcm1TdWJtaXRDb25maXJtKHsgY2FyZCwgY2FyZElkIH0pIHtcclxuICAgIGNvbnNvbGUubG9nKCd4Jyk7XHJcbiAgICAvLyBjb25zdCB0ZXh0ID0gJ9CU0LAuLi4nXHJcbiAgICBwb3B1cERlbGV0ZS5nZXRCdXR0b25UZXh0KClcclxuICAgIGFwaS5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICBjYXJkLmRlbGV0ZUJ1dHRvbkNhcmQoKVxyXG4gICAgICAgICAgICBwb3B1cERlbGV0ZS5nZXRCdXR0b25UZXh0KClcclxuICAgICAgICAgICAgcG9wdXBEZWxldGUuY2xvc2UoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnJvciA9PiBjb25zb2xlLmVycm9yKGDQntGI0LjQsdC60LAg0L/RgNC4INGD0LTQsNC70LXQvdC40Lgg0LrQsNGA0YLQvtGH0LrQuCAke2Vycm9yfWApKSlcclxufVxyXG5wb3B1cERlbGV0ZS5zZXRFdmVudExpc3RlbmVycygpXHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/RgNC10LDQu9C40LfQsNGG0LjRjyDQutC70LDRgdGB0LAgU2VjdGlvbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0pIHtcclxuICAgIGNvbnN0IGNhcmRzID0gbmV3IENhcmQoaXRlbSwgcG9wdXBPcGVuSW1hZ2VTZWN0aW9uXHJcbiAgICAgICAgLm9wZW4sICcuZWxlbWVudHMtdGVtcGxhdGUnLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaWQgPSBjYXJkcy5nZXRJZCgpXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGlkKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3gnKTtcclxuICAgICAgICAgICAgcG9wdXBEZWxldGUub3BlbigpLFxyXG4gICAgICAgICAgICAgICAgcG9wdXBEZWxldGUuc2V0U3VibWl0SGFubGRlcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBpLmRlbGV0ZUNhcmQoaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkcy5kZWxldGVCdXR0b25DYXJkKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBEZWxldGUuY2xvc2UoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvciA9PiBjb25zb2xlLmVycm9yKGDQntGI0LjQsdC60LAg0L/RgNC4INGD0LTQsNC70LXQvdC40Lgg0LrQsNGA0YLQuNC90LrQuCAke2Vycm9yfWApKSlcclxuICAgICAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHBvcHVwRGVsZXRlLnNldEJ1dHRvblRleHQoKSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIChsaWtlRWxlbWVudCwgY2FyZElkKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChsaWtlRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2VsZW1lbnRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgICAgICBhcGkuZGVsZXRlTGlrZShjYXJkSWQpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHMudG9nZ2xlTGlrZShyZXMubGlrZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoYNCe0YjQuNCx0LrQsCDQv9GA0Lgg0YPQtNCw0LvQtdC90LjQuCDQu9Cw0LnQutCwICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYXBpLmFkZExpa2UoY2FyZElkKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzLnRvZ2dsZUxpa2UocmVzLmxpa2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvciA9PiBjb25zb2xlLmVycm9yKGDQntGI0LjQsdC60LAg0L/RgNC4INC/0L7RgdGC0LDQstC6INC70LDQudC60LAgJHtlcnJvcn1gKSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZHMuZ2VuZXJhdGVDYXJkKClcclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5wb3B1cERlbGV0ZS5zZXRTdWJtaXRIYW5sZGVyKClcclxuY29uc3QgY2FyZExpc3RTZWxlY3RvciA9ICcuZWxlbWVudHNfX2xpc3QtdGVtcGxhdGUnO1xyXG5jb25zdCBjYXJkc0xpc3RTZWN0aW9uID0gbmV3IFNlY3Rpb24oKGl0ZW0pID0+IHtcclxuICAgIGNhcmRzTGlzdFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxufSxcclxuICAgIGNhcmRMaXN0U2VsZWN0b3JcclxuKTtcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0JLQkNCb0JjQlNCQ0KbQmNCvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmNvbnN0IGZvcm1FZGl0VmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybUVsZW1lbnRFZGl0KVxyXG5jb25zdCBmb3JtQWRkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybUVsZW1lbnRBZGQpXHJcbmNvbnN0IGZvcm1BdmF0YXJWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtRWxlbWVudEF2YXRhcilcclxuXHJcbi8vICAvL1wi0JLQutC70Y7Rh9Cw0LXQvFwiINC/0L7QtNC/0LjRgdC60Lgg0L3QsCDQuNC30LzQtdC90LXQvdC40Y8g0LIg0LjQvdC/0YPRgtCw0YVcclxuZm9ybUVkaXRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpXHJcbmZvcm1BZGRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpXHJcbmZvcm1BdmF0YXJWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/QntGB0L3QvtCy0LAgQVBJLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5Qcm9taXNlLmFsbChbYXBpLmdldEluZm8oKSwgYXBpLmdldENhcmQoKV0pXHJcbiAgICAudGhlbigoW2RhdGFVc2VyLCBkYXRhQ2FyZF0pID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhQ2FyZCk7XHJcbiAgICAgICAgdXNlcklkID0gZGF0YVVzZXIuX2lkXHJcbiAgICAgICAgY29uc29sZS5sb2codXNlcklkKTtcclxuICAgICAgICBkYXRhQ2FyZC5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBlbGVtZW50Lm15aWQgPSB1c2VySWRcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhVXNlcik7XHJcbiAgICAgICAgdXNlckluZm8uc2VyVXNlckluZm8oeyBhdmF0YXI6IGRhdGFVc2VyLmF2YXRhciwgZmlyc3RuYW1lOiBkYXRhVXNlci5uYW1lLCBkZXNjcmlwdGlvbjogZGF0YVVzZXIuYWJvdXQgfSlcclxuICAgICAgICBjYXJkc0xpc3RTZWN0aW9uLnJlbmRlckl0ZW1zKGRhdGFDYXJkLnJldmVyc2UoKSlcclxuXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihg0J7RiNC40LHQutCwINC/0YDQuCDQvdCw0YfQsNC70YzQvdGL0YUg0LTQsNC90L3Ri9C5INGB0YLRgNCw0L3QuNGG0YsgJHtlcnJvcn1gKSlcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5fdXJsID0gb3B0aW9ucy5iYXNlVXJsXHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzXHJcbiAgICB0aGlzLl9hdXRob3JpemF0aW9uID0gb3B0aW9ucy5oZWFkZXJzLmF1dGhvcml6YXRpb25cclxuICB9XHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQp9GC0L4t0YLQviDQv9C+0YjQu9C+INC90LUg0YLQsNC6OiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9XHJcbiAgZ2V0Q2FyZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLmZpcnN0bmFtZSxcclxuICAgICAgICBhYm91dDogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIHNldFVzZXJBdmF0YXIoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIGFkZENhcmQoZGF0YSl7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH1cclxuICBhZGRMaWtlKGNhcmRJZCl7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIGRlbGV0ZUxpa2UoY2FyZElkKXtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9XHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpe1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG5cclxuICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl90ZXh0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fdGV4dFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4gPSAobmFtZSwgbGluaykgPT4ge1xyXG4gICAgdGhpcy5fdGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lXHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgc3VwZXIub3BlbigpXHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgICAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcubmFtZVNlbGVjdG9yKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuam9iU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmF2YXRhclNlbGVjdG9yKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0bmFtZTogIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3Byb2ZpbGVUZXh0LnRleHRDb250ZW50XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHNlclVzZXJJbmZvKHthdmF0YXIsIGZpcnN0bmFtZSwgZGVzY3JpcHRpb259KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhclxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBmaXJzdG5hbWVcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVUZXh0LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb25cclxuICAgICAgICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB9XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aERlbGV0ZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGZvcm1TdWJtaXQpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLmZvcm1TdWJtaXQgPSBmb3JtU3VibWl0O1xyXG4gICAgICAgIHRoaXMucG9wdXBCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmVkLWJ1dHRvbicpO1xyXG4gICAgICAgIHRoaXMucG9wdXBCdXR0b25Mb2FkaW5nID0gdGhpcy5wb3B1cEJ1dHRvbi50ZXh0Q29udGVudDtcclxuXHJcbiAgICB9XHJcbiAgICBfc3VibWl0ID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIC8vICB0aGlzLnBvcHVwQnV0dG9uLnRleHRDb250ZW50ID0gYCR7dGhpcy5wb3B1cEJ1dHRvbi50ZXh0Q29udGVudH0uLi5gO1xyXG4gICAgICAgIHRoaXMucG9wdXBCdXR0b24udGV4dENvbnRlbnQgPSAn0JTQsC4uLidcclxuICAgICAgICB0aGlzLmZvcm1TdWJtaXQoKHsgY2FyZDogdGhpcy5fZWxlbWVudCwgY2FyZElEOiB0aGlzLl9jYXJkSUQgfSkpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMucG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9zdWJtaXQpXHJcbiAgICB9XHJcblxyXG4gICAgc2V0U3VibWl0SGFubGRlcihuZXdGb3JtU3VibWl0KSB7XHJcbiAgICAgICAgdGhpcy5mb3JtU3VibWl0ID0gbmV3Rm9ybVN1Ym1pdFxyXG4gICAgfVxyXG4gICAgc2V0QnV0dG9uVGV4dCgpIHtcclxuICAgICAgICAgICAgdGhpcy5wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMucG9wdXBCdXR0b25Mb2FkaW5nXHJcbiAgICAgICAgfSBcclxuXHJcbiAgICBvcGVuID0gKGNhcmQsIGNhcmRJZCkgPT4ge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKVxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBjYXJkO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJRCA9IGNhcmRJZDtcclxuICAgIH1cclxufSIsIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7IFxyXG4gICAgfVxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KVxyXG4gICAgfVxyXG4gICAgcmVuZGVySXRlbXMoZGF0YSkge1xyXG4gICAgLy9yZW5kZXJlcigpIHtcclxuICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIoaXRlbSlcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImhhbmRsZUNhcmRDbGljayIsInRlbXBsYXRlU2VsZWN0b3IiLCJvcGVuQ29uZmlybSIsInB1dExpa2UiLCJ0aGlzIiwiY2FyZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9teWlkIiwibXlpZCIsIl9jYXJkSWQiLCJfaWQiLCJfbGlrZXMiLCJsaWtlcyIsIl9saWtlc0xlbmd0aCIsImxlbmd0aCIsIl9wdXRMaWtlIiwiX293bmVySWQiLCJvd25lciIsIl9vcGVuQ29uZmlybSIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl92aXNpYmxlRGVsZXRlQnV0dG9uIiwiX2RlbGV0ZSIsInN0eWxlIiwidmlzaWJpbGl0eSIsIl9jb3VudExpa2UiLCJmb3JFYWNoIiwiZWxlbWVudCIsIl9jb3VudGVyIiwidGV4dENvbnRlbnQiLCJfYnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwiZ2VuZXJhdGVDYXJkIiwiX2VsZW1lbnQiLCJfaW1hZ2UiLCJfdGV4dCIsImFsdCIsInNyYyIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQ2FyZCIsInRvZ2dsZUxpa2UiLCJ0b2dnbGUiLCJkZWxldGVCdXR0b25DYXJkIiwicmVtb3ZlIiwiZ2V0SWQiLCJvcGVuSW1nIiwiX2hhbmRsZU9wZW5EZWxldGUiLCJjYXJkSUQiLCJfY2FyZElEIiwiYWRkRXZlbnRMaXN0ZW5lciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJfcG9wdXBDbG9zZUJ1dHRvbiIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdEFkZCIsInN1cGVyIiwiX2Zvcm0iLCJfaW5wdXQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY29uc29sZSIsImxvZyIsIl9wb3B1cEJ1dHRvbiIsIl9wb3B1cEJ1dHRvbkxvYWRpbmciLCJyZXNldCIsIl9nZXRJbnB1dFZhbHVlcyIsInZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dHNWYWx1ZXMiLCJkYXRhVXNlciIsIl9vblN1Ym1pdCIsInByZXZlbnREZWZhdWx0Iiwic2V0QnV0dG9uVGV4dCIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJfc3VibWl0QnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsImJ1dHRvbiIsInJlbW92ZUF0dHJpYnV0ZSIsImRpc2FibGVCdXR0b24iLCJzZXRBdHRyaWJ1dGUiLCJfc2hvd0lucHV0RXJyb3IiLCJmb3JtRXJyb3IiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImZvcm1JbnB1dCIsInNvbWUiLCJpdGVtIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJjaGVja1ZhbGlkaXR5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dEVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwicG9wdXBFZGl0RWxlbWVudCIsInBvcHVwQWRkRWxlbWVudCIsInBvcHVwQXZhdGFyRWxlbWVudCIsInByb2ZpbGVCdXR0b25FbGVtZW50IiwicHJvZmlsZUVkaXRCdXR0b25FbGVtZW50IiwicHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnQiLCJhdmF0YXJCdXR0b24iLCJmb3JtRWxlbWVudEVkaXQiLCJmb3JtRWxlbWVudEFkZCIsImZvcm1FbGVtZW50QXZhdGFyIiwiYXBpIiwib3B0aW9ucyIsIl91cmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2F1dGhvcml6YXRpb24iLCJhdXRob3JpemF0aW9uIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5mbyIsImZldGNoIiwidGhlbiIsImdldENhcmQiLCJzZXRVc2VySW5mbyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZmlyc3RuYW1lIiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhZGRDYXJkIiwidGl0bGUiLCJhZGRMaWtlIiwiY2FyZElkIiwiZGVsZXRlTGlrZSIsImRlbGV0ZUNhcmQiLCJ1c2VySWQiLCJwb3B1cE9wZW5JbWFnZVNlY3Rpb24iLCJ1c2VySW5mbyIsIl9wcm9maWxlTmFtZSIsIm5hbWVTZWxlY3RvciIsIl9wcm9maWxlVGV4dCIsImpvYlNlbGVjdG9yIiwiX3Byb2ZpbGVBdmF0YXIiLCJhdmF0YXJTZWxlY3RvciIsImdldFVzZXJJbmZvIiwic2VyVXNlckluZm8iLCJlZGl0UG9wdXBXaXRoRm9ybSIsInVzZXJJbmZvQWxsIiwiY2F0Y2giLCJlcnJvciIsImZpbmFsbHkiLCJhZGR0UG9wdXBXaXRoRm9ybSIsImZvcm1BZGRWYWxpZGF0b3IiLCJhbGwiLCJkYXRhQ2FyZCIsImNhcmRzTGlzdFNlY3Rpb24iLCJhZGRJdGVtIiwiY3JlYXRlQ2FyZCIsImF2YXRhclBvcHVwIiwiZm9ybUF2YXRhclZhbGlkYXRvciIsInBvcHVwRGVsZXRlIiwiZm9ybVN1Ym1pdCIsInBvcHVwQnV0dG9uIiwicG9wdXBCdXR0b25Mb2FkaW5nIiwiX3N1Ym1pdCIsInNldFN1Ym1pdEhhbmxkZXIiLCJuZXdGb3JtU3VibWl0IiwiZ2V0QnV0dG9uVGV4dCIsImNhcmRzIiwibGlrZUVsZW1lbnQiLCJjb250YWlucyIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfY29udGFpbmVyIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiZm9ybUVkaXRWYWxpZGF0b3IiLCJyZXZlcnNlIl0sInNvdXJjZVJvb3QiOiIifQ==