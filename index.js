(()=>{"use strict";class t{constructor(t,e,s,o,i){this._name=t.name,this._link=t.link,this._myid=t.myid,this._cardId=t._id,this._likes=t.likes,this._likesLength=t.likes.length,this._putLike=i,this._ownerId=t.owner._id,this._openConfirm=o,this._templateSelector=s,this.handleCardClick=e}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_visibleDeleteButton(){this._myid===this._ownerId?this._detete.style.visibility="visible":this._myid!==this._ownerId&&(this._detete.style.visibility="hidden")}_countLike(){this._likes.forEach((t=>{t._id!==this._myid?this._counter.textContent=this._likesLength:this._button.classList.add("element__like-button_active")}))}generateCard(){return this._element=this._getTemplate(),this._counter=this._element.querySelector(".element__like-count"),this._detete=this._element.querySelector(".element__delete"),this._button=this._element.querySelector(".element__like-button"),this._image=this._element.querySelector(".element__image"),this._text=this._element.querySelector(".element__title"),this._text.textContent=this._name,this._image.alt=this._name,this._image.src=this._link,this._countLike(),this._visibleDeleteButton(),this._setEventListeners(),this._element}_likeCard(){this._putLike(this._button,this._cardId)}toggleLike(t){this._button.classList.toggle("element__like-button_active"),this._counter.textContent=t.length}_deleteButtonCard(){this._element.remove(),this._element=null}openImg(){this.handleCardClick(this._name,this._link)}_handleOpenDelete(){this._openConfirm({card:this,cardID:this._cardID})}_setEventListeners(){this._button.addEventListener("click",(()=>{this._likeCard()})),this._image.addEventListener("click",(()=>{this.openImg()})),this._detete.addEventListener("click",(()=>{this._handleOpenDelete()}))}}class e{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._popupCloseButton=this._popup.querySelector(".popup__close")}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(t=>{t.target===t.currentTarget&&this.close()})),this._popupCloseButton.addEventListener("click",(()=>{this.close()}))}}class s extends e{constructor(t,e){super(t),this.formSubmitAdd=e,this._form=this._popup.querySelector(".form"),this._input=this._popup.querySelectorAll(".form__item"),console.log(this._input),this._popupButton=this._popup.querySelector(".popup__saved-button"),this._popupButtonLoading=this._popupButton.textContent}close(){super.close(),this._form.reset()}_getInputValues(){return this.values={},this._input.forEach((t=>{this.values[t.name]=t.value})),this.values}setInputsValues(t){this._input.forEach((e=>{e.value=t[e.name]}))}_onSubmit=t=>{t.preventDefault(),this._popupButton.textContent=`${this._popupButton.textContent}...`,this.formSubmitAdd(this._getInputValues())};setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this._onSubmit)}setButtonText(t){this._popupButton.textContent=this._popupButtonLoading}}const o={formSelector:".form",inputSelector:".form__item",submitButtonSelector:".popup__saved-button",inactiveButtonClass:"popup__saved-button_disabled",inputErrorClass:"form__item-error",errorClass:"error_opened"};class i{constructor(t,e){this.formSelector=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=Array.from(this.formSelector.querySelectorAll(this._inputSelector)),this._submitButton=this.formSelector.querySelector(this._submitButtonSelector)}_enableButton(t){t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled")}disableButton(t){t.classList.add(this._inactiveButtonClass),t.setAttribute("disabled",!0)}_showInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}_hideInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}_hasInvalidInput(t){return t.some((t=>!t.validity.valid))}_checkInputValidity(t){t.checkValidity()?this._hideInputError(t):this._showInputError(t)}setEventListeners(){this.disableButton(this._submitButton),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this.toggleButtonState(),this._checkInputValidity(t)}))}))}toggleButtonState(){this._hasInvalidInput(this._inputList)?this.disableButton(this._submitButton):this._enableButton(this._submitButton)}resetValidation(){this.toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}enableValidation(){this.setEventListeners()}}const n=document.querySelector(".popup_type_edit"),r=document.querySelector(".popup_type_add"),a=(document.querySelector(".popup_type_image"),document.querySelector(".popup_type_confirm"),document.querySelector(".popup_type_avatar")),l=document.querySelector(".profile"),u=l.querySelector(".profile__edit-button"),h=l.querySelector(".profile__add-button"),c=n.querySelector(".form"),_=r.querySelector(".form"),p=a.querySelector(".form"),d=new class{constructor(t){this._url=t.baseUrl,this._headers=t.headers,this._authorization=t.headers.authorization}_checkResponse(t){return t.ok?t.json():Promise.reject(`Что-то пошло не так: ${t.status}`)}getInfo(){return fetch(`${this._url}/users/me`,{headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._checkResponse)}getCard(){return fetch(`${this._url}/cards`,{headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then(this._checkResponse)}setUserInfo(t){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t.firstname,about:t.description})}).then(this._checkResponse)}setUserAvatar(t){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t.avatar})}).then(this._checkResponse)}addCard(t){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t.title,link:t.link})}).then(this._checkResponse)}addLike(t){return fetch(`${this._url}/cards/${t}/likes`,{method:"PUT",headers:{authorization:this._authorization}}).then(this._checkResponse)}deleteLike(t){return fetch(`${this._url}/cards/${t}/likes`,{method:"DELETE",headers:{authorization:this._authorization}}).then(this._checkResponse)}deleteCard(t){return fetch(`${this._url}/cards/${t}`,{method:"DELETE",headers:{authorization:this._authorization}}).then(this._checkResponse)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-66",headers:{authorization:"26786be3-fed9-4d83-9ae2-1348eee1b7d5","Content-Type":"application/json"}}),m=new class extends e{constructor(t){super(t),this._image=this._popup.querySelector(".popup__image"),this._text=this._popup.querySelector(".popup__text")}open=(t,e)=>{this._text.textContent=t,this._image.alt=t,this._image.src=e,super.open()}}(".popup_type_image");m.setEventListeners();const f=new class{constructor(t){this._profileName=document.querySelector(t.nameSelector),this._profileText=document.querySelector(t.jobSelector),this._profileAvatar=document.querySelector(t.avatarSelector)}getUserInfo(){return{firstname:this._profileName.textContent,description:this._profileText.textContent}}serUserInfo({avatar:t,firstname:e,description:s}){this._profileAvatar.src=t,this._profileName.textContent=e,this._profileText.textContent=s}}({nameSelector:".profile__title",jobSelector:".profile__subtitle",avatarSelector:".profile__avatar"}),v=new s(".popup_type_edit",(function(t){d.setUserInfo(t).then((t=>{f.serUserInfo({avatar:t.avatar,firstname:t.name,description:t.about})})).catch((t=>console.error(`Ошибка при редактировании ${t}`))).finally((()=>v.setButtonText())),v.close()}));v.setEventListeners(),u.addEventListener("click",(function(){v.setInputsValues(f.getUserInfo()),console.log(f.getUserInfo()),v.open()}));const y=new s(".popup_type_add",(function(t){console.log("open"),Promise.all([d.getInfo(),d.addCard(t)]).then((([t,e])=>{console.log(e),e.myid=t._id,L.addItem(C(e)),y.close()})).catch((t=>console.error(`Ошибка при создании карточки ${t}`))).finally((()=>y.setButtonText()))}));y.setEventListeners(),h.addEventListener("click",(function(){y.open()}));const b=new s(".popup_type_avatar",(function(t){d.setUserAvatar(t).then((t=>{console.log(t),f.serUserInfo({avatar:t.avatar,firstname:t.name,description:t.about})})).catch((t=>console.error(`Ошибка при редактировании аватара ${t}`))).finally((()=>b.setButtonText())),b.close(),console.log("Close")}));b.setEventListeners();const S=document.querySelector(".profile__avatar-button");console.log(S),S.addEventListener("click",(function(){b.open()})),document.querySelector(".popup__saved-button_confirms");const g=new class extends e{constructor(t,e){super(t),this.formSubmit=e,this.popupButton=this._popup.querySelector(".popup__saved-button"),this.popupButtonLoading=this.popupButton.textContent}_submit=t=>{t.preventDefault(),this.popupButton.textContent=`${this.popupButton.textContent}...`,this.formSubmit({card:this._element,cardID:this._cardID})};setEventListeners(){super.setEventListeners(),this.popupButton.addEventListener("submit",this._submit)}setSubmitHanlder(t){this.formSubmit=t}setButtonText(t){this.popupButton.textContent=this.popupButtonLoading}open=(t,e)=>{super.open(),this._element=t,this._cardID=e}}(".popup_type_confirm",(function({card:t,cardId:e}){console.log("x"),d.deleteCard(e).then((e=>{console.log(e),t.deleteButtonCard(),g.close()})).catch((t=>console.error(`Ошибка при удалении карточки ${t}`))).finally((()=>g.setButtonText()))}));function C(e){const s=new t(e,m.open,".elements-template",(t=>{g.open(),g.setSubmitHanlder((()=>{d.deleteCard(t).then((()=>{s.deleteButtonCard()}))}))}),((t,e)=>{t.classList.contains("element__like-button_active")?d.deleteLike(e).then((t=>{console.log(t),s.toggleLike(t.likes)})).catch((t=>console.error(`Ошибка при удалении лайка ${t}`))):d.addLike(e).then((t=>{console.log(t),s.toggleLike(t.likes)})).catch((t=>console.error(`Ошибка при поставк лайка ${t}`)))}));return s.generateCard()}g.setEventListeners(),g.setSubmitHanlder();const L=new class{constructor(t,e){this.renderer=t,this._container=document.querySelector(e)}addItem(t){this._container.prepend(t)}renderItems(t){t.forEach((t=>{this.renderer(t)}))}}((t=>{L.addItem(C(t))}),".elements__list-template"),k=new i(o,c),E=new i(o,_),B=new i(o,p);k.enableValidation(),E.enableValidation(),B.enableValidation(),Promise.all([d.getInfo(),d.getCard()]).then((([t,e])=>{console.log(e),e.forEach((e=>{e.myid=t._id})),console.log(t),f.serUserInfo({avatar:t.avatar,firstname:t.name,description:t.about}),L.renderItems(e)})).catch((t=>console.error(`Ошибка при начальных данный страницы ${t}`)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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azovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0ZS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihjYXJkRGF0YSwgaGFuZGxlQ2FyZENsaWNrLCB0ZW1wbGF0ZVNlbGVjdG9yLCBvcGVuQ29uZmlybSwgcHV0TGlrZSkge1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgICAgIHRoaXMuX215aWQgPSBjYXJkRGF0YS5teWlkO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJZCA9IGNhcmREYXRhLl9pZFxyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gY2FyZERhdGEubGlrZXM7XHJcbiAgICAgICAgdGhpcy5fbGlrZXNMZW5ndGggPSBjYXJkRGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICAgICAgdGhpcy5fcHV0TGlrZSA9IHB1dExpa2U7XHJcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGNhcmREYXRhLm93bmVyLl9pZDtcclxuICAgICAgICB0aGlzLl9vcGVuQ29uZmlybSA9IG9wZW5Db25maXJtXHJcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcblxyXG4gICAgfVxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIC8vINC30LDQsdC40YDQsNC10Lwg0YDQsNC30LzQtdGC0LrRgyDQuNC3IEhUTUwg0Lgg0LrQu9C+0L3QuNGA0YPQtdC8INGN0LvQtdC80LXQvdGCXHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxyXG4gICAgICAgICAgICAuY29udGVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnQnKVxyXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICAgIH1cclxuICAgIF92aXNpYmxlRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9teWlkID09PSB0aGlzLl9vd25lcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RldGV0ZS5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnXHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9teWlkICE9PSB0aGlzLl9vd25lcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RldGV0ZS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbidcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfY291bnRMaWtlKCkge1xyXG4gICAgICAgIHRoaXMuX2xpa2VzLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50Ll9pZCA9PT0gdGhpcy5fbXlpZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2VsZW1lbnRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpXHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9jb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXNMZW5ndGhcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICAgICAgdGhpcy5fY291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2xpa2UtY291bnQnKVxyXG4gICAgICAgIHRoaXMuX2RldGV0ZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2RlbGV0ZScpXHJcbiAgICAgICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZS1idXR0b24nKVxyXG4gICAgICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faW1hZ2UnKVxyXG4gICAgICAgIHRoaXMuX3RleHQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X190aXRsZScpXHJcbiAgICAgICAgdGhpcy5fdGV4dC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIHRoaXMuX2NvdW50TGlrZSgpXHJcbiAgICAgICAgdGhpcy5fdmlzaWJsZURlbGV0ZUJ1dHRvbigpXHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCk0YPQvdC60YbQuNGPINC70LDQudC60LBcclxuICAgIF9saWtlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9wdXRMaWtlKHRoaXMuX2J1dHRvbiwgdGhpcy5fY2FyZElkKVxyXG4gICAgICAgIC8vIHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmUnKVxyXG4gICAgfTtcclxuICAgIHRvZ2dsZUxpa2UobGlrZXMpIHtcclxuICAgICAgICB0aGlzLl9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlJylcclxuICAgICAgICB0aGlzLl9jb3VudGVyLnRleHRDb250ZW50ID0gbGlrZXMubGVuZ3RoXHJcbiAgICB9XHJcbiAgICAvL9Ck0YPQvdC60YbQuNGPINGD0LTQsNC70LXQvdC40Y9cclxuICAgIF9kZWxldGVCdXR0b25DYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGxcclxuICAgIH1cclxuXHJcbiAgICBvcGVuSW1nKCkge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXHJcbiAgICB9XHJcbiAgICBfaGFuZGxlT3BlbkRlbGV0ZSgpIHtcclxuICAgICAgICB0aGlzLl9vcGVuQ29uZmlybSh7Y2FyZDogdGhpcywgY2FyZElEOiB0aGlzLl9jYXJkSUQgfSlcclxuICAgXHJcbiAgICB9XHJcbiAgICAvL9GB0LvRg9GI0LDRgtC10LvQuFxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIC8v0YHQu9GD0YjQsNGC0LXQu9GMINC70LDQudC60LBcclxuICAgICAgICB0aGlzLl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VDYXJkKClcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8v0YHQu9GD0YjQsNGC0LXQu9GMINGD0LTQsNC70Y/Qu9C60LhcclxuICAgICAgICAvLyB0aGlzLl9kZXRldGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbkNhcmQoKVxyXG4gICAgICAgIC8vIH0pXHJcbiAgICAgICAgLy/RgdC70YPRiNCw0YLQtdC70Ywg0L7RgtC60YDRi9GC0LjRjyDQutCw0YDRgtC40L3QutC4XHJcbiAgICAgICAgdGhpcy5faW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub3BlbkltZygpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gLy/RgdC70YPRiNCw0YLQtdC70YwgXHJcbiAgICAgICAgdGhpcy5fZGV0ZXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVPcGVuRGVsZXRlKClcclxuXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICAvL3RoaXMuX3BvcHVwID0gcG9wdXBTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy/QntGC0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8vL1xyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpXHJcblxyXG4gICAgfVxyXG4gICAgLy/Ql9Cw0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8vL1xyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKVxyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKVxyXG4gICAgfVxyXG4gICAgLy/Ql9Cw0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L8gRXNjLy9cclxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvL9Ch0LvRg9GI0LDRgtC10LvRjCDQt9Cw0LrRgNGL0YLQuNGPLCDQvdCw0LbQuNC80LDRjyDQvdCwINGC0LXQvNC9LtGN0LrRgNCw0L0g0Lgg0LfQsNC60YDRi9GC0LjQtSDQvdCwINC60L3QvtC/0LrRgyDQutGA0LXRgdGC0LjQui8vXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldClcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgZm9ybVN1Ym1pdEFkZCkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuZm9ybVN1Ym1pdEFkZCA9IGZvcm1TdWJtaXRBZGQ7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XHJcbiAgICAgICAgdGhpcy5faW5wdXQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybV9faXRlbScpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuX2lucHV0KTtcclxuICAgICAgICB0aGlzLl9wb3B1cEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fc2F2ZWQtYnV0dG9uJyk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBCdXR0b25Mb2FkaW5nID0gdGhpcy5fcG9wdXBCdXR0b24udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgfVxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKVxyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICB0aGlzLnZhbHVlcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2lucHV0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXM7XHJcbiAgICB9XHJcbiAgICBzZXRJbnB1dHNWYWx1ZXMoZGF0YVVzZXIpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IGRhdGFVc2VyW2lucHV0Lm5hbWVdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblN1Ym1pdCA9IChldnQpID0+IHtcclxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IGAke3RoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50fS4uLmA7XHJcbiAgICAgICAgdGhpcy5mb3JtU3VibWl0QWRkKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9vblN1Ym1pdClcclxuICAgIH1cclxuXHJcbiAgICBzZXRCdXR0b25UZXh0KHRleHQpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3BvcHVwQnV0dG9uTG9hZGluZ1xyXG4gICAgfVxyXG5cclxuXHJcbn1cclxuXHJcblxyXG5cclxuXHJcbiIsImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0gKHtcclxuICAgIGZvcm1TZWxlY3RvcjogJy5mb3JtJyxcclxuICAgIGlucHV0U2VsZWN0b3I6ICcuZm9ybV9faXRlbScsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fc2F2ZWQtYnV0dG9uJyxcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fc2F2ZWQtYnV0dG9uX2Rpc2FibGVkJyxcclxuICAgIGlucHV0RXJyb3JDbGFzczogJ2Zvcm1fX2l0ZW0tZXJyb3InLFxyXG4gICAgZXJyb3JDbGFzczogJ2Vycm9yX29wZW5lZCdcclxufSk7XHJcblxyXG5leHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm0pIHtcclxuICAgICAgICB0aGlzLmZvcm1TZWxlY3RvciA9IGZvcm0sXHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcixcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IsXHJcbiAgICAgICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyxcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcyxcclxuICAgICAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzLFxyXG5cclxuICAgICAgICAgICAgLy90aGlzLl9mb3JtID0gQXJyYXkuZnJvbSh0aGlzLmZvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKVxyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuX2Zvcm0pXHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5mb3JtU2VsZWN0b3IucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSlcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLmZvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKVxyXG4gICAgfVxyXG5cclxuICAgIC8vINC60L3QvtC/0LrQsCDQsNC60YLQuNCyXHJcbiAgICBfZW5hYmxlQnV0dG9uKGJ1dHRvbikge1xyXG4gICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpXHJcbiAgICAgICAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpXHJcbiAgICB9XHJcbiAgICAvLyDQutC90L7Qv9C60LAg0L3QtdCw0LrRgtC40LJcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uKSB7XHJcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcylcclxuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDQpNGD0L3QutGG0LjRjyAg0L/QvtC70Y8gYyDQvtGI0LjQsdC60L7QuVxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0KSB7XHJcbiAgICAgICAgY29uc3QgZm9ybUVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGZvcm1FcnJvci50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlXHJcbiAgICAgICAgZm9ybUVycm9yLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vICAvLyDQpNGD0L3QutGG0LjRjyAg0L/QvtC70Y8g0LHQtdC3INC+0YjQuNCx0LrQuFxyXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0KSB7XHJcbiAgICAgICAgY29uc3QgZm9ybUVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGZvcm1FcnJvci50ZXh0Q29udGVudCA9IFwiXCJcclxuICAgICAgICBmb3JtRXJyb3IuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH07XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dChmb3JtSW5wdXQpIHtcclxuICAgICAgICByZXR1cm4gZm9ybUlucHV0LnNvbWUoaXRlbSA9PiAhaXRlbS52YWxpZGl0eS52YWxpZClcclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XHJcbiAgICAgICAgaWYgKGlucHV0LmNoZWNrVmFsaWRpdHkoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dClcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyAvL9GE0YPQvdC60YbQuNGPINGB0LvRg9GI0LDRgtC10LvQtdC5XHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAgICB0aGlzLmRpc2FibGVCdXR0b24odGhpcy5fc3VibWl0QnV0dG9uKVxyXG4gICAgICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KVxyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbilcclxuICAgICAgICAgICAgLy8gICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vICAgICB0aGlzLl9lbmFibGVCdXR0b24odGhpcy5fc3VibWl0QnV0dG9uKVxyXG4gICAgICAgICAgICAvLyAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfTtcclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKCl7XHJcbiAgICBcclxuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKHRoaXMuX3N1Ym1pdEJ1dHRvbilcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAodGhpcy5fZW5hYmxlQnV0dG9uKCh0aGlzLl9zdWJtaXRCdXR0b24pKSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7IFxyXG4gIFxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudClcclxuICAgICAgICB9KTtcclxuICBcclxuICAgICAgfVxyXG4gICAgLy8gICAvL9GE0YPQvdC60YbQuNGPINC30LDQv9GD0YHQutCwINCy0YvQu9C40LTQsNGG0LjQuFxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKClcclxuICAgIH1cclxufVxyXG5cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9Ch0LDRhdCw0LvQuNC9JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9saXZlLnN0YXRpY2ZsaWNrci5jb20vNjU1MzUvNTE2NjQzMTM3MDVfNTcxMzc5MTI1N19rLmpwZydcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgdGl0bGU6ICfQlNCw0LPQtdGB0YLQsNC9JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9saXZlLnN0YXRpY2ZsaWNrci5jb20vMTk1OC80NDM2ODk3ODMwNF8yNzMyYjU4MzI1X2suanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9CY0LLQsNC90L7QstC+JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2l2YW5vdm8uanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9Ca0LDQvNGH0LDRgtC60LAnLFxyXG4gICAgICAgIGxpbms6ICdodHRwczovL2xpdmUuc3RhdGljZmxpY2tyLmNvbS82NTUzNS80ODgyMDEwMDUzMl84N2ExY2ViMTBkX2suanBnJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICB0aXRsZTogJ9Cl0L7Qu9C80L7Qs9C+0YDRgdC60LjQuSDRgNCw0LnQvtC9JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2tob2xtb2dvcnNreS1yYXlvbi5qcGcnXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIHRpdGxlOiAn0JHQsNC50LrQsNC7JyxcclxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9saXZlLnN0YXRpY2ZsaWNrci5jb20vNjU1MzUvNTE0MjEyMDU0MzRfODkxM2Y0YTFhNV9rLmpwZydcclxuICAgIH1cclxuXTtcclxuXHJcbi8vINCd0LDRhdC+0LTQuNC8IHBvcHVwXHJcbmNvbnN0IHBvcHVwRWRpdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfZWRpdFwiKTtcclxuY29uc3QgcG9wdXBBZGRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2FkZFwiKTtcclxuY29uc3QgcG9wdXBPcGVuSW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX2ltYWdlXCIpO1xyXG5jb25zdCBwb3B1cENsb3NlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2NvbmZpcm0nKVxyXG5jb25zdCBwb3B1cEF2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hdmF0YXInKVxyXG5cclxuLy8g0J3QsNGF0L7QtNC40Lwg0LrQvdC+0L/QutC4XHJcbmNvbnN0IHByb2ZpbGVCdXR0b25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQgPSBwcm9maWxlQnV0dG9uRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQnV0dG9uRWxlbWVudCA9IHByb2ZpbGVCdXR0b25FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcblxyXG5cclxuLy8g0J3QsNGF0L7QtNC40Lwg0L/QvtC70Y8g0YTQvtGA0LzRiyDQsiBET01cclxuY29uc3QgZm9ybUVsZW1lbnRFZGl0ID0gcG9wdXBFZGl0RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmNvbnN0IGZvcm1FbGVtZW50QWRkID0gcG9wdXBBZGRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuY29uc3QgZm9ybUVsZW1lbnRBdmF0YXIgPSBwb3B1cEF2YXRhckVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG5cclxuZXhwb3J0IHsgcG9wdXBFZGl0RWxlbWVudCwgcG9wdXBBZGRFbGVtZW50LCBwb3B1cE9wZW5JbWFnZUVsZW1lbnQsIHBvcHVwQ2xvc2VFbGVtZW50LCBwb3B1cEF2YXRhckVsZW1lbnQsIHByb2ZpbGVCdXR0b25FbGVtZW50LCBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQsIHByb2ZpbGVBZGRCdXR0b25FbGVtZW50LCBmb3JtRWxlbWVudEVkaXQsIGZvcm1FbGVtZW50QWRkLCBmb3JtRWxlbWVudEF2YXRhciB9IiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gJy4uL2NvbXBvbmVudHMvU2VjdGlvbi5qcydcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMnXHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcydcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnXHJcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnXHJcbmltcG9ydCBQb3B1cFdpdGhEZWxldGUgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanMnXHJcblxyXG5pbXBvcnQgeyB2YWxpZGF0aW9uQ29uZmlnIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJ1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJ1xyXG4vL2ltcG9ydCB7IGluaXRpYWxDYXJkcyB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcydcclxuLy9pbml0aWFsQ2FyZHMucmV2ZXJzZSgpO1xyXG5pbXBvcnQgJy4vaW5kZXguY3NzJ1xyXG5cclxuaW1wb3J0IHsgcG9wdXBFZGl0RWxlbWVudCwgcG9wdXBBZGRFbGVtZW50LCBwb3B1cE9wZW5JbWFnZUVsZW1lbnQsIHBvcHVwQ2xvc2VFbGVtZW50LCBwb3B1cEF2YXRhckVsZW1lbnQsIHByb2ZpbGVCdXR0b25FbGVtZW50LCBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnQsIHByb2ZpbGVBZGRCdXR0b25FbGVtZW50LCBmb3JtRWxlbWVudEVkaXQsIGZvcm1FbGVtZW50QWRkLCBmb3JtRWxlbWVudEF2YXRhciB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcydcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/Qn9C+0LTQutGO0YcuINC6INGB0LXRgNCy0LXRgNGDLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICAgIGJhc2VVcmw6ICdodHRwczovL21lc3RvLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTY2JyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiAnMjY3ODZiZTMtZmVkOS00ZDgzLTlhZTItMTM0OGVlZTFiN2Q1JyxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9XHJcbn0pO1xyXG4vLyAgIGNvbnNvbGUubG9nKGFwaSlcclxuLy8gICBhcGkuZ2V0Q2FyZCgpXHJcbi8vICAgICAudGhlbihyZXMgPT4gY29uc29sZS5sb2cocmVzKSlcclxuXHJcbi8vICAgYXBpLmdldEluZm8oKVxyXG4vLyAgICAgLnRoZW4ocmVzID0+IGNvbnNvbGUubG9nKHJlcykpXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL9Cf0L7Qv9Cw0L8g0L7RgtC60YDRi9GC0LjRjyDQutCw0YDRgtC+0YfQtdC6Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgcG9wdXBPcGVuSW1hZ2VFbGVtZW50U2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2ltYWdlXCJcclxuXHJcbmNvbnN0IHBvcHVwT3BlbkltYWdlU2VjdGlvbiA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cE9wZW5JbWFnZUVsZW1lbnRTZWxlY3RvcilcclxucG9wdXBPcGVuSW1hZ2VTZWN0aW9uLnNldEV2ZW50TGlzdGVuZXJzKClcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuXHJcbi8v0J/QvtC/0LDQvyBFRElUXHJcbmNvbnN0IGNvbmZpZyA9IHtcclxuICAgIG5hbWVTZWxlY3RvcjogJy5wcm9maWxlX190aXRsZScsXHJcbiAgICBqb2JTZWxlY3RvcjogJy5wcm9maWxlX19zdWJ0aXRsZScsXHJcbiAgICBhdmF0YXJTZWxlY3RvcjogJy5wcm9maWxlX19hdmF0YXInXHJcbn1cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oY29uZmlnKTtcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL9Cf0L7Qv9Cw0L8gRURJVC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgcG9wdXBFZGl0RWxlbWVudFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9lZGl0XCJcclxuY29uc3QgZWRpdFBvcHVwV2l0aEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cEVkaXRFbGVtZW50U2VsZWN0b3IsIGZvcm1TdWJtaXRFZGl0KVxyXG5cclxuZnVuY3Rpb24gZm9ybVN1Ym1pdEVkaXQoZGF0YSkge1xyXG4gICAgYXBpLnNldFVzZXJJbmZvKGRhdGEpXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgdXNlckluZm8uc2VyVXNlckluZm8oeyBhdmF0YXI6IHJlcy5hdmF0YXIsIGZpcnN0bmFtZTogcmVzLm5hbWUsIGRlc2NyaXB0aW9uOiByZXMuYWJvdXQgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyb3IgPT4gY29uc29sZS5lcnJvcihg0J7RiNC40LHQutCwINC/0YDQuCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC4ICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IGVkaXRQb3B1cFdpdGhGb3JtLnNldEJ1dHRvblRleHQoKSlcclxuXHJcbiAgICBlZGl0UG9wdXBXaXRoRm9ybS5jbG9zZSgpXHJcbn1cclxuZWRpdFBvcHVwV2l0aEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG4vLy/QmNC60L7QvdC60LAgRURJVC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxucHJvZmlsZUVkaXRCdXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcHJvZmlsZUVkaXRCdXR0b25FbGVtZW50RnVuY3Rpb24pO1xyXG5mdW5jdGlvbiBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnRGdW5jdGlvbigpIHtcclxuICAgIGVkaXRQb3B1cFdpdGhGb3JtLnNldElucHV0c1ZhbHVlcyh1c2VySW5mby5nZXRVc2VySW5mbygpKVxyXG4gICAgY29uc29sZS5sb2codXNlckluZm8uZ2V0VXNlckluZm8oKSk7XHJcbiAgICBlZGl0UG9wdXBXaXRoRm9ybS5vcGVuKClcclxufVxyXG4vLyBmdW5jdGlvbiBwcm9maWxlRWRpdEJ1dHRvbkVsZW1lbnRGdW5jdGlvbigpIHtcclxuLy8gICAgIGVkaXRQb3B1cFdpdGhGb3JtLm9wZW4oKVxyXG4vLyAgICAgY29uc3QgcHJvZmlsZURhdGEgID0gdXNlckluZm8uZ2V0VXNlckluZm8oKSAvLyDQktC+0YIg0YLRg9GCINCyINC/0LXRgNC10LzQtdC90L3Rg9GOIHByb2ZpbGVEYXRhINC/0L7Qu9C+0LbQuNC70Lgg0L7QsdGK0LXQutGCLCDRgtC+0YIg0YfRgtC+INGC0Ysg0LrQvtC90YHQvtC70YzQu9C+0LPQuNGA0YPQtdGI0Ywg0L3QsCDRgdC60YDQuNC90YjQvtGC0LUgXHJcbi8vICAgY29uc29sZS5sb2cocHJvZmlsZURhdGEpO1xyXG4vLyAgICAgbmFtZUVkaXRJbnB1dC52YWx1ZSA9IHByb2ZpbGVEYXRhLmZpcnN0bmFtZVxyXG4vLyAgICAgam9iRWRpdElucHV0LnZhbHVlID0gcHJvZmlsZURhdGEuZGVzY3JpcHRpb25cclxuLy8gICB9XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0J/QvtC/0LDQvyBBRC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgcG9wdXBBZGRFbGVtZW50U2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2FkZFwiXHJcbmNvbnN0IGFkZHRQb3B1cFdpdGhGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBBZGRFbGVtZW50U2VsZWN0b3IsIGZvcm1TdWJtaXRBZGQpXHJcblxyXG5mdW5jdGlvbiBmb3JtU3VibWl0QWRkKGRhdGEpIHtcclxuICAgIGNvbnNvbGUubG9nKCdvcGVuJyk7XHJcbiAgICBQcm9taXNlLmFsbChbYXBpLmdldEluZm8oKSwgYXBpLmFkZENhcmQoZGF0YSldKVxyXG4gICAgICAgIC50aGVuKChbZGF0YVVzZXIsIGRhdGFDYXJkXSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhQ2FyZCk7XHJcbiAgICAgICAgICAgIGRhdGFDYXJkLm15aWQgPSBkYXRhVXNlci5faWRcclxuICAgICAgICAgICAgY2FyZHNMaXN0U2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoZGF0YUNhcmQpKTtcclxuICAgICAgICAgICAgYWRkdFBvcHVwV2l0aEZvcm0uY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyb3IgPT4gY29uc29sZS5lcnJvcihg0J7RiNC40LHQutCwINC/0YDQuCDRgdC+0LfQtNCw0L3QuNC4INC60LDRgNGC0L7Rh9C60LggJHtlcnJvcn1gKSkpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gYWRkdFBvcHVwV2l0aEZvcm0uc2V0QnV0dG9uVGV4dCgpKVxyXG59O1xyXG5hZGR0UG9wdXBXaXRoRm9ybS5zZXRFdmVudExpc3RlbmVycygpXHJcblxyXG5cclxuLy8v0JjQutC+0L3QutCwIEFERC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxucHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwcm9maWxlQWRkQnV0dG9uRWxlbWVudEZ1bmN0aW9uKTtcclxuZnVuY3Rpb24gcHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnRGdW5jdGlvbigpIHtcclxuICAgIGFkZHRQb3B1cFdpdGhGb3JtLm9wZW4oKVxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL9Cf0L7Qv9Cw0L8gQVZBVEFSLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbmNvbnN0IHBvcHVwQXZhdGFyRWxlbWVudFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9hdmF0YXJcIlxyXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwQXZhdGFyRWxlbWVudFNlbGVjdG9yLCBmb3JtU3VibWl0QXZhdGFyKVxyXG5cclxuZnVuY3Rpb24gZm9ybVN1Ym1pdEF2YXRhcihkYXRhKSB7XHJcbiAgICBhcGkuc2V0VXNlckF2YXRhcihkYXRhKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgIHVzZXJJbmZvLnNlclVzZXJJbmZvKHsgYXZhdGFyOiByZXMuYXZhdGFyLCBmaXJzdG5hbWU6IHJlcy5uYW1lLCBkZXNjcmlwdGlvbjogcmVzLmFib3V0IH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoYNCe0YjQuNCx0LrQsCDQv9GA0Lgg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjQuCDQsNCy0LDRgtCw0YDQsCAke2Vycm9yfWApKSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiBhdmF0YXJQb3B1cC5zZXRCdXR0b25UZXh0KCkpXHJcblxyXG4gICAgYXZhdGFyUG9wdXAuY2xvc2UoKVxyXG4gICAgY29uc29sZS5sb2coJ0Nsb3NlJyk7XHJcbn07XHJcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKClcclxuXHJcbmNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXItYnV0dG9uJylcclxuY29uc29sZS5sb2coYXZhdGFyQnV0dG9uKTtcclxuLy8v0JjQutC+0L3QutCwIENMT1NFLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmb3JtKVxyXG5mdW5jdGlvbiBmb3JtKCkge1xyXG4gICAgYXZhdGFyUG9wdXAub3BlbigpXHJcbn1cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy/Qn9C+0L/QsNC/IENPTkZJUk0vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgcG9wdXBDb25maXJtRWxlbWVudFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9jb25maXJtXCJcclxuY29uc3QgQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlZC1idXR0b25fY29uZmlybXMnKVxyXG5jb25zdCBkZWZhdWx0QiA9ICfQlNCwLi4uJ1xyXG5jb25zdCBwb3B1cERlbGV0ZSA9IG5ldyBQb3B1cFdpdGhEZWxldGUocG9wdXBDb25maXJtRWxlbWVudFNlbGVjdG9yLCBmb3JtU3VibWl0Q29uZmlybSlcclxuZnVuY3Rpb24gZm9ybVN1Ym1pdENvbmZpcm0oeyBjYXJkLCBjYXJkSWQgfSkge1xyXG4gICAgY29uc29sZS5sb2coJ3gnKTtcclxuICAgIGFwaS5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICBjYXJkLmRlbGV0ZUJ1dHRvbkNhcmQoKVxyXG4gICAgICAgICAgICBwb3B1cERlbGV0ZS5jbG9zZSgpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoYNCe0YjQuNCx0LrQsCDQv9GA0Lgg0YPQtNCw0LvQtdC90LjQuCDQutCw0YDRgtC+0YfQutC4ICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHBvcHVwRGVsZXRlLnNldEJ1dHRvblRleHQoKSlcclxuXHJcbn1cclxucG9wdXBEZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0YDQtdCw0LvQuNC30LDRhtC40Y8g0LrQu9Cw0YHRgdCwIFNlY3Rpb24vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgICBjb25zdCBjYXJkcyA9IG5ldyBDYXJkKGl0ZW0sIHBvcHVwT3BlbkltYWdlU2VjdGlvblxyXG4gICAgICAgIC5vcGVuLCAnLmVsZW1lbnRzLXRlbXBsYXRlJyxcclxuICAgICAgICAoaWQpID0+IHtcclxuICAgICAgICAgICAgcG9wdXBEZWxldGUub3BlbigpLFxyXG4gICAgICAgICAgICAgICAgcG9wdXBEZWxldGUuc2V0U3VibWl0SGFubGRlcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBpLmRlbGV0ZUNhcmQoaWQpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHMuZGVsZXRlQnV0dG9uQ2FyZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pICAgXHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgfSxcclxuICAgICAgICAobGlrZUVsZW1lbnQsIGNhcmRJZCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAobGlrZUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmUnKSkge1xyXG4gICAgICAgICAgICAgICAgYXBpLmRlbGV0ZUxpa2UoY2FyZElkKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzLnRvZ2dsZUxpa2UocmVzLmxpa2VzKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvciA9PiBjb25zb2xlLmVycm9yKGDQntGI0LjQsdC60LAg0L/RgNC4INGD0LTQsNC70LXQvdC40Lgg0LvQsNC50LrQsCAke2Vycm9yfWApKSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwaS5hZGRMaWtlKGNhcmRJZClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkcy50b2dnbGVMaWtlKHJlcy5saWtlcylcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IgPT4gY29uc29sZS5lcnJvcihg0J7RiNC40LHQutCwINC/0YDQuCDQv9C+0YHRgtCw0LLQuiDQu9Cw0LnQutCwICR7ZXJyb3J9YCkpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRzLmdlbmVyYXRlQ2FyZCgpXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxucG9wdXBEZWxldGUuc2V0U3VibWl0SGFubGRlcigpXHJcbmNvbnN0IGNhcmRMaXN0U2VsZWN0b3IgPSAnLmVsZW1lbnRzX19saXN0LXRlbXBsYXRlJztcclxuY29uc3QgY2FyZHNMaXN0U2VjdGlvbiA9IG5ldyBTZWN0aW9uKChpdGVtKSA9PiB7XHJcbiAgICBjYXJkc0xpc3RTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChpdGVtKSk7XHJcbn0sXHJcbiAgICBjYXJkTGlzdFNlbGVjdG9yXHJcbik7XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL9CS0JDQm9CY0JTQkNCm0JjQry8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5jb25zdCBmb3JtRWRpdFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGZvcm1FbGVtZW50RWRpdClcclxuY29uc3QgZm9ybUFkZFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGZvcm1FbGVtZW50QWRkKVxyXG5jb25zdCBmb3JtQXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybUVsZW1lbnRBdmF0YXIpXHJcblxyXG4vLyAgLy9cItCS0LrQu9GO0YfQsNC10LxcIiDQv9C+0LTQv9C40YHQutC4INC90LAg0LjQt9C80LXQvdC10L3QuNGPINCyINC40L3Qv9GD0YLQsNGFXHJcbmZvcm1FZGl0VmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKVxyXG5mb3JtQWRkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKVxyXG5mb3JtQXZhdGFyVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKVxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v0J7RgdC90L7QstCwIEFQSS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbmZvKCksIGFwaS5nZXRDYXJkKCldKVxyXG4gICAgLnRoZW4oKFtkYXRhVXNlciwgZGF0YUNhcmRdKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YUNhcmQpO1xyXG4gICAgICAgIGRhdGFDYXJkLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQubXlpZCA9IGRhdGFVc2VyLl9pZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGFVc2VyKTtcclxuICAgICAgICB1c2VySW5mby5zZXJVc2VySW5mbyh7IGF2YXRhcjogZGF0YVVzZXIuYXZhdGFyLCBmaXJzdG5hbWU6IGRhdGFVc2VyLm5hbWUsIGRlc2NyaXB0aW9uOiBkYXRhVXNlci5hYm91dCB9KVxyXG4gICAgICAgIGNhcmRzTGlzdFNlY3Rpb24ucmVuZGVySXRlbXMoZGF0YUNhcmQpXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihg0J7RiNC40LHQutCwINC/0YDQuCDQvdCw0YfQsNC70YzQvdGL0YUg0LTQsNC90L3Ri9C5INGB0YLRgNCw0L3QuNGG0YsgJHtlcnJvcn1gKSlcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5fdXJsID0gb3B0aW9ucy5iYXNlVXJsXHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzXHJcbiAgICB0aGlzLl9hdXRob3JpemF0aW9uID0gb3B0aW9ucy5oZWFkZXJzLmF1dGhvcml6YXRpb25cclxuICB9XHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQp9GC0L4t0YLQviDQv9C+0YjQu9C+INC90LUg0YLQsNC6OiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9XHJcbiAgZ2V0Q2FyZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLmZpcnN0bmFtZSxcclxuICAgICAgICBhYm91dDogZGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIHNldFVzZXJBdmF0YXIoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIGFkZENhcmQoZGF0YSl7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gIH1cclxuICBhZGRMaWtlKGNhcmRJZCl7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgfVxyXG4gIGRlbGV0ZUxpa2UoY2FyZElkKXtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcclxuICB9XHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpe1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG5cclxuICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl90ZXh0ID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fdGV4dFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4gPSAobmFtZSwgbGluaykgPT4ge1xyXG4gICAgdGhpcy5fdGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lXHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgc3VwZXIub3BlbigpXHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgICAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcubmFtZVNlbGVjdG9yKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuam9iU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmF2YXRhclNlbGVjdG9yKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0bmFtZTogIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3Byb2ZpbGVUZXh0LnRleHRDb250ZW50XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHNlclVzZXJJbmZvKHthdmF0YXIsIGZpcnN0bmFtZSwgZGVzY3JpcHRpb259KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhclxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBmaXJzdG5hbWVcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2ZpbGVUZXh0LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb25cclxuICAgICAgICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB9XHJcbi8vIGV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuLy8gICAgIGNvbnN0cnVjdG9yKG5hbWUsIHRleHQpIHtcclxuLy8gICAgICAgICB0aGlzLl9pbnB1dE5hbWUgPSBuYW1lXHJcbi8vICAgICAgICAgdGhpcy5faW5wdXRUZXh0ID0gdGV4dFxyXG4vLyAgICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XHJcbi8vICAgICAgICAgdGhpcy5fcHJvZmlsZVRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fc3VidGl0bGUnKTtcclxuLy8gICAgIH1cclxuICAgXHJcbi8vICAgICBnZXRVc2VySW5mbygpIHtcclxuLy8gICAgICAgICByZXR1cm4ge1xyXG4vLyAgICAgICAgIG5hbWU6IHRoaXMuX2lucHV0TmFtZS52YWx1ZSA9IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4vLyAgICAgICAgIHRleHQ6IHRoaXMuX2lucHV0VGV4dC52YWx1ZSA9IHRoaXMuX3Byb2ZpbGVUZXh0LnRleHRDb250ZW50XHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfVxyXG4vLyAgICAgLy8gc2VyVXNlckluZm8obmFtZSwgdGV4dCkge1xyXG4vLyAgICAgLy8gICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZVxyXG4vLyAgICAgLy8gICAgIHRoaXMuX3Byb2ZpbGVUZXh0LnRleHRDb250ZW50ID0gdGV4dFxyXG4vLyAgICAgLy8gIH1cclxuLy8gICAgIHNldFVzZXJJbmZvKCkge1xyXG5cclxuLy8gICAgICAgICB0aGlzLl9pbnB1dE5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl9wcm9maWxlTmFtZS52YWx1ZSxcclxuLy8gICAgICAgICB0aGlzLl9pbnB1dFRleHQudGV4dENvbnRlbnQgPSB0aGlzLl9wcm9maWxlVGV4dC52YWx1ZVxyXG5cclxuLy8gICAgIH1cclxuLy8gfSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aERlbGV0ZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGZvcm1TdWJtaXQpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLmZvcm1TdWJtaXQgPSBmb3JtU3VibWl0O1xyXG4gICAgICAgIHRoaXMucG9wdXBCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmVkLWJ1dHRvbicpO1xyXG4gICAgICAgIHRoaXMucG9wdXBCdXR0b25Mb2FkaW5nID0gdGhpcy5wb3B1cEJ1dHRvbi50ZXh0Q29udGVudDtcclxuXHJcbiAgICB9XHJcbiAgICBfc3VibWl0ID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMucG9wdXBCdXR0b24udGV4dENvbnRlbnQgPSBgJHt0aGlzLnBvcHVwQnV0dG9uLnRleHRDb250ZW50fS4uLmA7XHJcbiAgICAgICAgdGhpcy5mb3JtU3VibWl0KCh7IGNhcmQ6IHRoaXMuX2VsZW1lbnQsIGNhcmRJRDogdGhpcy5fY2FyZElEIH0pKTtcclxuICAgICAgICBcclxuICAgICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICB0aGlzLnBvcHVwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX3N1Ym1pdClcclxuICAgIH1cclxuICAgIFxyXG4gICAgc2V0U3VibWl0SGFubGRlciAobmV3Rm9ybVN1Ym1pdCApe1xyXG4gICAgICAgIHRoaXMuZm9ybVN1Ym1pdCA9IG5ld0Zvcm1TdWJtaXRcclxuICAgIH1cclxuICAgIFxyXG4gICAgc2V0QnV0dG9uVGV4dCh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9ICB0aGlzLnBvcHVwQnV0dG9uTG9hZGluZ1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4gPSAoY2FyZCwgY2FyZElkICkgPT4ge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKVxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBjYXJkO1xyXG4gICAgICAgIHRoaXMuX2NhcmRJRCA9IGNhcmRJZDtcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuICAgIC8vIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAvLyAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgLy8gICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIC8vICAgICAgICAgdGhpcy5mb3JtU3VibWl0KCh7IGNhcmQ6IHRoaXMuX2VsZW1lbnQsIGNhcmRJRDogdGhpcy5fY2FyZElEIH0pKTtcclxuICAgIC8vICAgICAgICAgdGhpcy5jbG9zZSgpXHJcbiAgICAvLyAgICAgfSlcclxuICAgIC8vIH1cclxuIiwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAvLyAgdGhpcy5faW5pdGlhbEFycmF5ID0gZGF0YTtcclxuICAgICAgIC8vIHRoaXMuX2l0ZW1zPSBpdGVtcztcclxuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7IFxyXG4gICAgfVxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAvL3RoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudClcclxuICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpXHJcbiAgICB9XHJcbiAgICByZW5kZXJJdGVtcyhkYXRhKSB7XHJcbiAgICAvL3JlbmRlcmVyKCkge1xyXG4gICAgICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlcihpdGVtKVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJjYXJkRGF0YSIsImhhbmRsZUNhcmRDbGljayIsInRlbXBsYXRlU2VsZWN0b3IiLCJvcGVuQ29uZmlybSIsInB1dExpa2UiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX215aWQiLCJteWlkIiwiX2NhcmRJZCIsIl9pZCIsIl9saWtlcyIsImxpa2VzIiwiX2xpa2VzTGVuZ3RoIiwibGVuZ3RoIiwiX3B1dExpa2UiLCJfb3duZXJJZCIsIm93bmVyIiwiX29wZW5Db25maXJtIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3Zpc2libGVEZWxldGVCdXR0b24iLCJfZGV0ZXRlIiwic3R5bGUiLCJ2aXNpYmlsaXR5IiwiX2NvdW50TGlrZSIsImZvckVhY2giLCJlbGVtZW50IiwiX2NvdW50ZXIiLCJ0ZXh0Q29udGVudCIsIl9idXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJnZW5lcmF0ZUNhcmQiLCJfZWxlbWVudCIsIl9pbWFnZSIsIl90ZXh0IiwiYWx0Iiwic3JjIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VDYXJkIiwidG9nZ2xlTGlrZSIsInRvZ2dsZSIsIl9kZWxldGVCdXR0b25DYXJkIiwicmVtb3ZlIiwib3BlbkltZyIsIl9oYW5kbGVPcGVuRGVsZXRlIiwiY2FyZCIsImNhcmRJRCIsIl9jYXJkSUQiLCJhZGRFdmVudExpc3RlbmVyIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9wb3B1cENsb3NlQnV0dG9uIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJmb3JtU3VibWl0QWRkIiwic3VwZXIiLCJfZm9ybSIsIl9pbnB1dCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjb25zb2xlIiwibG9nIiwiX3BvcHVwQnV0dG9uIiwiX3BvcHVwQnV0dG9uTG9hZGluZyIsInJlc2V0IiwiX2dldElucHV0VmFsdWVzIiwidmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldElucHV0c1ZhbHVlcyIsImRhdGFVc2VyIiwiX29uU3VibWl0IiwicHJldmVudERlZmF1bHQiLCJzZXRCdXR0b25UZXh0IiwidGV4dCIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJfc3VibWl0QnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsImJ1dHRvbiIsInJlbW92ZUF0dHJpYnV0ZSIsImRpc2FibGVCdXR0b24iLCJzZXRBdHRyaWJ1dGUiLCJfc2hvd0lucHV0RXJyb3IiLCJmb3JtRXJyb3IiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImZvcm1JbnB1dCIsInNvbWUiLCJpdGVtIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJjaGVja1ZhbGlkaXR5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dEVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwicG9wdXBFZGl0RWxlbWVudCIsInBvcHVwQWRkRWxlbWVudCIsInBvcHVwQXZhdGFyRWxlbWVudCIsInByb2ZpbGVCdXR0b25FbGVtZW50IiwicHJvZmlsZUVkaXRCdXR0b25FbGVtZW50IiwicHJvZmlsZUFkZEJ1dHRvbkVsZW1lbnQiLCJmb3JtRWxlbWVudEVkaXQiLCJmb3JtRWxlbWVudEFkZCIsImZvcm1FbGVtZW50QXZhdGFyIiwiYXBpIiwib3B0aW9ucyIsIl91cmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2F1dGhvcml6YXRpb24iLCJhdXRob3JpemF0aW9uIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5mbyIsImZldGNoIiwidGhlbiIsImdldENhcmQiLCJzZXRVc2VySW5mbyIsImRhdGEiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImZpcnN0bmFtZSIsImFib3V0IiwiZGVzY3JpcHRpb24iLCJzZXRVc2VyQXZhdGFyIiwiYXZhdGFyIiwiYWRkQ2FyZCIsInRpdGxlIiwiYWRkTGlrZSIsImNhcmRJZCIsImRlbGV0ZUxpa2UiLCJkZWxldGVDYXJkIiwicG9wdXBPcGVuSW1hZ2VTZWN0aW9uIiwidXNlckluZm8iLCJfcHJvZmlsZU5hbWUiLCJuYW1lU2VsZWN0b3IiLCJfcHJvZmlsZVRleHQiLCJqb2JTZWxlY3RvciIsIl9wcm9maWxlQXZhdGFyIiwiYXZhdGFyU2VsZWN0b3IiLCJnZXRVc2VySW5mbyIsInNlclVzZXJJbmZvIiwiZWRpdFBvcHVwV2l0aEZvcm0iLCJjYXRjaCIsImVycm9yIiwiZmluYWxseSIsImFkZHRQb3B1cFdpdGhGb3JtIiwiYWxsIiwiZGF0YUNhcmQiLCJjYXJkc0xpc3RTZWN0aW9uIiwiYWRkSXRlbSIsImNyZWF0ZUNhcmQiLCJhdmF0YXJQb3B1cCIsImF2YXRhckJ1dHRvbiIsInBvcHVwRGVsZXRlIiwiZm9ybVN1Ym1pdCIsInBvcHVwQnV0dG9uIiwicG9wdXBCdXR0b25Mb2FkaW5nIiwiX3N1Ym1pdCIsInNldFN1Ym1pdEhhbmxkZXIiLCJuZXdGb3JtU3VibWl0IiwiZGVsZXRlQnV0dG9uQ2FyZCIsImNhcmRzIiwibGlrZUVsZW1lbnQiLCJjb250YWlucyIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfY29udGFpbmVyIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiZm9ybUVkaXRWYWxpZGF0b3IiLCJmb3JtQWRkVmFsaWRhdG9yIiwiZm9ybUF2YXRhclZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=